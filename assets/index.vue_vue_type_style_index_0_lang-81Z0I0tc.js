
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as k,p as x,b as V,a as C,c as y,d as D,u as F,e as M}from"./homePage-BkNAV5h0.js";import{a as N}from"./tenant_tenantHomepageSetting-Bm-SKTnK.js";import{d as B,X as O,r as d,a as m,i,o as S,e as T,w as l,f as u,g as f,x as j,j as z,$ as E,ak as P}from"./index-BTP43HjK.js";const X=B({__name:"index",emits:["fetch-data"],setup(R,{expose:p,emit:_}){const g=_,e=O({title:"",dialogFormVisible:!1,form:{}}),a=d(null),c=d(null),v=t=>{e.title="编辑",e.form=t,e.dialogFormVisible=!0},b=async()=>{await E(),a.value=k.init({container:c.value,height:"100vh",width:"100%",plugins:[x,V,C,y],i18n:{locale:"zh",messages:{zh:D}},projectData:JSON.parse(e.form.rawData||"{}"),storageManager:!1,deviceManager:{devices:[{id:"desktop",name:"Desktop",width:""},{id:"tablet",name:"Tablet",width:"768px",widthMedia:"992px"},{id:"mobilePortrait",name:"Mobile portrait",width:"320px",widthMedia:"575px"}]}}),a.value.on("block:custom",t=>{F(t.blocks)}),M.forEach(t=>{a.value.Blocks.add(t.id,t)})},h=async()=>{const t=a.value.getHtml(),o=a.value.getCss(),s=JSON.stringify(a.value.getProjectData());e.form={...e.form,html:t,css:o,rawData:s};const{status:n}=await N.edit(e.form);n===1&&P.success({message:"编辑成功",center:!0}),g("fetch-data"),r()},r=()=>{a.value&&(a.value.destroy(),a.value=null),e.form={},e.dialogFormVisible=!1};return p({showEdit:v}),(t,o)=>{const s=m("el-button"),n=m("el-drawer");return i(e).dialogFormVisible?(S(),T(n,{key:0,modelValue:i(e).dialogFormVisible,"onUpdate:modelValue":o[0]||(o[0]=w=>i(e).dialogFormVisible=w),title:i(e).title,size:"80%",onOpened:b,onClose:r},{footer:l(()=>[u(s,{onClick:r},{default:l(()=>[f("取 消")]),_:1}),u(s,{type:"primary",onClick:h},{default:l(()=>[f("确 定")]),_:1})]),default:l(()=>[j("div",{ref_key:"formRef",ref:c},null,512)]),_:1},8,["modelValue","title"])):z("",!0)}}});export{X as _};
