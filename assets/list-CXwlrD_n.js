
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{g as A,m as N,u as fe,o as d,c as I,B as ge,F as O,a,n as V,Q as j,M as H,r as ve,q as _e,D as R,I as be,i as s,s as he,w as t,av as $,t as x,b as i,G as z,j as v,l as E,aF as F,E as G,e as we,aA as Ee,aB as Ce,aE as B,_ as ye,d as K}from"./index-C3PJOLdt.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-B9mKUhVQ.js";import xe from"./index-Bnmeu5MN.js";import{a as D}from"./setting_user-BFvHOZfN.js";import{u as Ve}from"./usePagination-Dbxb6R6L.js";import{u as ke}from"./useTabbar-D5-A52A4.js";import"./index.vue_vue_type_script_setup_true_lang-DBrb1a1R.js";import"./setting_role-CjggcPbH.js";const Pe={key:0,class:"absolute bottom-0 left-0 w-full translate-y-1/2 text-center"},Se=A({name:"SearchBar",__name:"index",props:N({showToggle:{type:Boolean,default:!0},background:{type:Boolean,default:!1}},{fold:{type:Boolean,default:!0},foldModifiers:{}}),emits:N(["toggle"],["update:fold"]),setup(_,{emit:c}){const k=c,p=fe(_,"fold");function C(){p.value=!p.value,k("toggle",p.value)}return(f,e)=>{const u=H;return d(),I("div",{class:j(["relative",{"py-4":f.showToggle,"px-4 bg-[var(--g-bg)] transition":f.background}])},[ge(f.$slots,"default",{fold:p.value,toggle:C}),f.showToggle?(d(),I("div",Pe,[O("button",{class:"h-5 inline-flex cursor-pointer select-none items-center border-size-0 rounded bg-[var(--g-bg)] px-2 text-xs font-medium outline-none",onClick:C},[a(u,{name:p.value?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])])])):V("",!0)],2)}}}),$e=_=>(Ee("data-v-fb82c77c"),_=_(),Ce(),_),ze=$e(()=>O("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),q=A({name:"SettingUserList",__name:"list",setup(_){const{pagination:c,onSizeChange:k,onCurrentChange:p,onSortChange:C}=Ve(),f=ke(),e=ve({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:"",row:""},editProps:{visible:!1,id:""},search:{account:"",name:"",mobile:"",sex:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});_e(()=>{u(),e.value.formMode==="router"&&R.on("get-data-list",()=>{u()})}),be(()=>{e.value.formMode==="router"&&R.off("get-data-list")});function u(){e.value.loading=!0,D.list().then(n=>{e.value.loading=!1,e.value.dataList=n.data,c.value.total=n.data.length,e.value.dataList.forEach(o=>{o.statusLoading=!1})})}function J(){Object.assign(e.value.search,{account:"",name:"",mobile:"",sex:""}),u()}function Q(n){k(n).then(()=>u())}function m(n=1){p(n).then(()=>u())}function W({prop:n,order:o}){C(n,o).then(()=>u())}function X(){e.value.formMode==="router"?f.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0)}function Y(n){e.value.formMode==="router"?f.open({name:"pagesExampleGeneralManagerEdit",params:{id:n.id}}):(e.value.formModeProps.id=n.id,e.value.formModeProps.row=JSON.stringify(n),e.value.formModeProps.visible=!0)}function Z(n){return new Promise(o=>{F.confirm(`确认${n.active?"禁用":"启用"}「${n.account}」吗？`,"确认信息").then(()=>{e.value.loading=!0,D.edit({id:n.id,account:null,name:null,sex:null,phoneNumber:null,active:!n.active}).then(()=>(G.success({message:`${n.active?"禁用":"启用"}成功`,center:!0}),u(),e.value.loading=!1,o(!0))).catch(()=>(e.value.loading=!1,o(!1)))}).catch(()=>o(!1))})}function ee(n){e.value.editProps=n,e.value.editProps.visible=!0}function ae(n){F.confirm(`确认删除「${n.account}」用户吗？`,"确认信息").then(()=>{D.delete(n.id).then(()=>{u(),G.success({message:"删除成功",center:!0})})}).catch(()=>{})}function oe(n,o){switch(n){case"assignRoles":ee(o);break;case"delete":ae(o);break}}return(n,o)=>{const P=s("ElInput"),w=s("ElFormItem"),y=s("ElRadioButton"),te=s("ElRadioGroup"),M=H,b=s("ElButton"),le=s("ElForm"),ne=Se,se=s("ElDivider"),T=s("ElSpace"),g=s("ElTableColumn"),U=s("el-text"),S=s("ElTag"),ie=s("ElSwitch"),L=s("ElDropdownItem"),re=s("ElDropdownMenu"),ue=s("ElDropdown"),de=s("ElTable"),me=s("ElPagination"),ce=we,pe=he("loading");return d(),I("div",{class:j({"absolute-container":e.value.tableAutoHeight})},[a(ce,null,{default:t(()=>[a(ne,{"show-toggle":!1},{default:t(({fold:l,toggle:h})=>[a(le,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[a(w,null,{default:t(()=>[a(P,{modelValue:e.value.search.account,"onUpdate:modelValue":o[0]||(o[0]=r=>e.value.search.account=r),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:o[1]||(o[1]=$(r=>m(),["enter"])),onClear:o[2]||(o[2]=r=>m())},null,8,["modelValue"])]),_:1}),x(a(w,null,{default:t(()=>[a(P,{modelValue:e.value.search.name,"onUpdate:modelValue":o[3]||(o[3]=r=>e.value.search.name=r),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:o[4]||(o[4]=$(r=>m(),["enter"])),onClear:o[5]||(o[5]=r=>m())},null,8,["modelValue"])]),_:2},1536),[[B,!l]]),x(a(w,null,{default:t(()=>[a(P,{modelValue:e.value.search.mobile,"onUpdate:modelValue":o[6]||(o[6]=r=>e.value.search.mobile=r),placeholder:"请输入手机号",clearable:"",onKeydown:o[7]||(o[7]=$(r=>m(),["enter"])),onClear:o[8]||(o[8]=r=>m())},null,8,["modelValue"])]),_:2},1536),[[B,!l]]),x(a(w,null,{default:t(()=>[a(te,{modelValue:e.value.search.sex,"onUpdate:modelValue":o[9]||(o[9]=r=>e.value.search.sex=r),onChange:o[10]||(o[10]=r=>m())},{default:t(()=>[a(y,{label:""},{default:t(()=>[i(" 全部 ")]),_:1}),a(y,{label:1},{default:t(()=>[i(" 男 ")]),_:1}),a(y,{label:0},{default:t(()=>[i(" 女 ")]),_:1}),a(y,{label:2},{default:t(()=>[i(" 保密 ")]),_:1})]),_:1},8,["modelValue"])]),_:2},1536),[[B,!l]]),a(w,null,{default:t(()=>[a(b,{type:"primary",onClick:o[11]||(o[11]=r=>m())},{icon:t(()=>[a(M,{name:"i-ep:search"})]),default:t(()=>[i(" 筛选 ")]),_:1}),a(b,{onClick:J},{icon:t(()=>[ze]),default:t(()=>[i(" 重置 ")]),_:1}),a(b,{link:"",onClick:h},{icon:t(()=>[a(M,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[i(" "+z(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(se,{"border-style":"dashed"}),a(T,{wrap:""},{default:t(()=>[a(b,{type:"primary",size:"default",onClick:X},{icon:t(()=>[a(M,{name:"i-ep:plus"})]),default:t(()=>[i(" 新增用户 ")]),_:1})]),_:1}),x((d(),v(de,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:W,onSelectionChange:o[12]||(o[12]=l=>e.value.batch.selectionDataList=l)},{default:t(()=>[e.value.batch.enable?(d(),v(g,{key:0,type:"selection",align:"center",fixed:""})):V("",!0),a(g,{prop:"account",sortable:"",label:"帐号"}),a(g,{prop:"name",label:"姓名",width:"100",align:"center"},{default:t(({row:l})=>[a(U,{class:"mx-1"},{default:t(()=>[i(z(l.name?l.name:"暂无数据"),1)]),_:2},1024)]),_:1}),a(g,{prop:"sex",label:"性别",width:"100",align:"center"},{default:t(l=>[l.row.sex===1?(d(),v(S,{key:0,type:"success",size:"small"},{default:t(()=>[i(" 男 ")]),_:1})):l.row.sex===0?(d(),v(S,{key:1,type:"warning",size:"small"},{default:t(()=>[i(" 女 ")]),_:1})):(d(),v(S,{key:2,type:"info",size:"small"},{default:t(()=>[i(" 保密 ")]),_:1}))]),_:1}),a(g,{prop:"mobile",label:"手机号",width:"150",align:"center"},{default:t(({row:l})=>[a(U,{class:"mx-1"},{default:t(()=>[i(z(l.phoneNumber?l.phoneNumber:"暂无数据"),1)]),_:2},1024)]),_:1}),a(g,{label:"状态",width:"100",align:"center"},{default:t(l=>[a(ie,{modelValue:l.row.active,"onUpdate:modelValue":h=>l.row.active=h,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>Z(l.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1}),a(g,{label:"操作",width:"200",align:"center",fixed:"right"},{default:t(l=>[a(T,null,{default:t(()=>[a(b,{type:"primary",size:"small",plain:"",onClick:h=>Y(l.row)},{default:t(()=>[i(" 编辑 ")]),_:2},1032,["onClick"]),a(ue,{onCommand:h=>oe(h,l.row)},{dropdown:t(()=>[a(re,null,{default:t(()=>[a(L,{command:"assignRoles"},{default:t(()=>[i(" 分配角色 ")]),_:1}),a(L,{command:"delete",divided:""},{default:t(()=>[i(" 删除 ")]),_:1})]),_:1})]),default:t(()=>[a(b,{size:"small"},{default:t(()=>[i(" 更多操作 "),a(M,{name:"i-ep:arrow-down",class:"el-icon--right"})]),_:1})]),_:2},1032,["onCommand"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[pe,e.value.loading]]),a(me,{"current-page":E(c).page,total:E(c).total,"page-size":E(c).size,"page-sizes":E(c).sizes,layout:E(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:m,onSizeChange:Q},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(d(),v(Me,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":o[13]||(o[13]=l=>e.value.formModeProps.visible=l),row:e.value.formModeProps.row,mode:e.value.formMode,onSuccess:u},null,8,["id","modelValue","row","mode"])):V("",!0),e.value.editProps.visible?(d(),v(xe,{key:1,id:e.value.editProps.id,modelValue:e.value.editProps.visible,"onUpdate:modelValue":o[14]||(o[14]=l=>e.value.editProps.visible=l),row:e.value.editProps,onSuccess:u},null,8,["id","modelValue","row"])):V("",!0)],2)}}});typeof K=="function"&&K(q);const Fe=ye(q,[["__scopeId","data-v-fb82c77c"]]);export{Fe as default};
