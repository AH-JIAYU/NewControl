
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{f as w,I as O,p as $,Y as D,r as H,y as J,z as y,D as j,h as m,ai as z,o as u,c as _,a as n,w as l,b as h,aj as U,k as o,i as f,$ as A,a0 as F,l as b,L as R,ap as Y,H as q,e as G,B as K,_ as Q}from"./index-CJp8R_z-.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-Cp8Ot5sV.js";import{a as X,E as Z}from"./index-CZ5lj3NK.js";import{u as I,a as ee}from"./supplieMenu-CEwDvxQ5.js";import{u as te}from"./tenantButtonPermission-BRPyklWr.js";import{u as ae}from"./useTabbar-Dh8Z9pdP.js";import"./index-CAAblGLH.js";import"./tenant_tenantPermission-CI5CW1kq.js";const oe={key:0},se=w({name:"supplie_permission",__name:"list",setup(ie){const E=te();I();const S=O(),k=ae(),g=$();D("success",d);const e=H({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,menulev:1,path:"",auths:[],id:""},EditProps:{id:"",visible:!1,row:""},search:{title:""},dataList:[]});J(()=>{d(),e.value.formMode==="router"&&y.on("get-data-list",()=>{d()})}),j(()=>{e.value.formMode==="router"&&y.off("get-data-list")});function P(t,s){t&&s&&t.forEach(a=>{a.children&&a.children.length>0&&(a.auths=P(a.children,s));const r=s.filter(p=>p.menu===a.path);return a.auths=r,[]})}async function d(){e.value.formModeProps.visible=!1,e.value.loading=!0;const t=await X.list();E.tenantPermissions=t.data;const a=(await ee.list({type:"normal"})).data;if(P(a,t.data),e.value.dataList=a,e.value.loading=!1,e.value.formModeProps.id){const r=M(e.value.dataList,e.value.formModeProps.id);e.value.formModeProps.auths=JSON.stringify(r.auths)}}function M(t,s){for(const a of t){if(a.id===s)return a;if(a.children){const r=M(a.children,s);if(r)return r}}return null}function B(){e.value.EditProps.id=11,e.value.EditProps.visible=!0,e.value.EditProps.row=JSON.stringify({})}function C(t){e.value.formMode==="router"?g.settings.tabbar.enable&&g.settings.tabbar.mergeTabsBy!=="activeMenu"?k.open({name:"multilevel_menu_examplePermissionsEdit",params:{id:t.id,menulev:t.menuLevel,path:t.path,auths:JSON.stringify(t.auths)}}):S.push({name:"multilevel_menu_examplePermissionsEdit",params:{id:t.id,menulev:t.menuLevel,path:t.path,auths:JSON.stringify(t.auths)}}):(e.value.formModeProps.id=t.id,e.value.formModeProps.menulev=t.menuLevel,e.value.formModeProps.auths=JSON.stringify(t.auths),e.value.formModeProps.visible=!0)}return(t,s)=>{const a=Y,r=q,p=m("ElButton"),L=m("ElSpace"),c=m("ElTableColumn"),x=m("el-tag"),V=m("ElTable"),N=G,T=z("loading");return u(),_("div",{class:R({"absolute-container":o(e).tableAutoHeight})},[n(a,{title:"权限管理管理"}),n(N,null,{default:l(()=>[n(L,{wrap:""},{default:l(()=>[n(p,{type:"primary",size:"default",onClick:B},{icon:l(()=>[n(r,{name:"i-ep:plus"})]),default:l(()=>[h(" 新增按钮权限 ")]),_:1})]),_:1}),U((u(),f(V,{data:o(e).dataList,"row-key":"id",stripe:"","highlight-current-row":"","default-expand-all":"",border:"",style:{lineHeight:"normal"}},{default:l(()=>[n(c,{prop:"meta.title",width:"300",label:"模块"}),n(c,{label:"权限"},{default:l(({row:i})=>[(u(!0),_(A,null,F(i.auths,v=>(u(),f(x,{key:v.id,type:"primary"},{default:l(()=>[h(K(v.label),1)]),_:2},1024))),128))]),_:1}),n(c,{label:"操作",width:"250",align:"center",fixed:"right"},{default:l(i=>[i.row.menuLevel>2&&i.row.auths.length?(u(),_("div",oe,[n(p,{type:"primary",size:"small",plain:"",onClick:v=>C(i.row)},{default:l(()=>[h(" 详情 ")]),_:2},1032,["onClick"])])):b("",!0)]),_:1})]),_:1},8,["data"])),[[T,o(e).loading]])]),_:1}),o(e).formMode==="dialog"||o(e).formMode==="drawer"?(u(),f(W,{key:0,id:o(e).formModeProps.id,modelValue:o(e).formModeProps.visible,"onUpdate:modelValue":s[0]||(s[0]=i=>o(e).formModeProps.visible=i),path:o(e).formModeProps.path,auths:o(e).formModeProps.auths,menulev:o(e).formModeProps.menulev,mode:o(e).formMode,onSuccess:d},null,8,["id","modelValue","path","auths","menulev","mode"])):b("",!0),o(e).EditProps.visible?(u(),f(Z,{key:1,modelValue:o(e).EditProps.visible,"onUpdate:modelValue":s[1]||(s[1]=i=>o(e).EditProps.visible=i),onSuccess:d},null,8,["modelValue"])):b("",!0)],2)}}}),ce=Q(se,[["__scopeId","data-v-9db9212e"]]);export{ce as default};
