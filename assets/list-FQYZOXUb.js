
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{f as re,r as ue,y as de,z as I,D as me,h as i,ai as ce,o as c,c as pe,a,w as o,av as P,aj as y,b as s,B as M,i as p,l as k,k as h,L as fe,cm as U,ak as L,H as ve,e as ge,bG as _e,bE as be,A as he,c9 as S,_ as Ee,d as N}from"./index-DNIrU4FX.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-OJ6RC6IG.js";import{_ as Ce}from"./index.vue_vue_type_script_setup_true_lang-DipPNacv.js";import ye from"./index-B20K4L2g.js";import{a as z}from"./setting_user-vF7zaZN2.js";import{u as Me}from"./usePagination-xNH93Cro.js";import{u as xe}from"./useTabbar-BGLabecg.js";import"./index.vue_vue_type_script_setup_true_lang-RJgtXO91.js";import"./setting_role-BreKjnKP.js";const Ve=E=>(_e("data-v-3f47e947"),E=E(),be(),E),Pe=Ve(()=>he("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),R=re({name:"multilevel_menu_exampleUser",__name:"list",setup(E){const{pagination:f,onSizeChange:T,onCurrentChange:G,onSortChange:F}=Me(),$=xe(),e=ue({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:"",row:""},editProps:{visible:!1,id:""},search:{account:"",name:"",mobile:"",sex:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});de(()=>{u(),e.value.formMode==="router"&&I.on("get-data-list",()=>{u()})}),me(()=>{e.value.formMode==="router"&&I.off("get-data-list")});function u(){e.value.loading=!0,z.list().then(n=>{var l;e.value.loading=!1,e.value.dataList=n.data,f.value.total=(l=n.data)==null?void 0:l.length,e.value.dataList.forEach(_=>{_.statusLoading=!1})})}function K(){Object.assign(e.value.search,{account:"",name:"",mobile:"",sex:""}),u()}function A(n){T(n).then(()=>u())}function d(n=1){G(n).then(()=>u())}function H({prop:n,order:l}){F(n,l).then(()=>u())}function O(){e.value.formMode==="router"?$.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0)}function j(n){e.value.formMode==="router"?$.open({name:"pagesExampleGeneralManagerEdit",params:{id:n.id}}):(e.value.formModeProps.id=n.id,e.value.formModeProps.row=JSON.stringify(n),e.value.formModeProps.visible=!0)}function J(n){return new Promise(l=>{U.confirm(`确认${n.active?"禁用":"启用"}「${n.account}」吗？`,"确认信息").then(()=>{e.value.loading=!0,z.edit({id:n.id,account:null,name:null,sex:null,phoneNumber:null,active:!n.active}).then(()=>(L.success({message:`${n.active?"禁用":"启用"}成功`,center:!0}),u(),e.value.loading=!1,l(!0))).catch(()=>(e.value.loading=!1,l(!1)))}).catch(()=>l(!1))})}function q(n){e.value.editProps=n,e.value.editProps.visible=!0}function Q(n){U.confirm(`确认删除「${n.account}」用户吗？`,"确认信息").then(()=>{z.delete({id:n.id}).then(()=>{u(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}function W(n,l){switch(n){case"assignRoles":q(l);break;case"delete":Q(l);break}}return(n,l)=>{const _=i("ElInput"),b=i("ElFormItem"),w=i("ElRadioButton"),X=i("ElRadioGroup"),C=ve,v=i("ElButton"),Y=i("ElForm"),Z=we,ee=i("ElDivider"),D=i("ElSpace"),m=i("ElTableColumn"),x=i("el-text"),V=i("ElTag"),ae=i("ElSwitch"),B=i("ElDropdownItem"),oe=i("ElDropdownMenu"),le=i("ElDropdown"),te=i("ElTable"),ne=i("ElPagination"),se=ge,ie=ce("loading");return c(),pe("div",{class:fe({"absolute-container":e.value.tableAutoHeight})},[a(se,null,{default:o(()=>[a(Z,{"show-toggle":!1},{default:o(({fold:t,toggle:g})=>[a(Y,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[a(b,null,{default:o(()=>[a(_,{modelValue:e.value.search.account,"onUpdate:modelValue":l[0]||(l[0]=r=>e.value.search.account=r),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:l[1]||(l[1]=P(r=>d(),["enter"])),onClear:l[2]||(l[2]=r=>d())},null,8,["modelValue"])]),_:1}),y(a(b,null,{default:o(()=>[a(_,{modelValue:e.value.search.name,"onUpdate:modelValue":l[3]||(l[3]=r=>e.value.search.name=r),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:l[4]||(l[4]=P(r=>d(),["enter"])),onClear:l[5]||(l[5]=r=>d())},null,8,["modelValue"])]),_:2},1536),[[S,!t]]),y(a(b,null,{default:o(()=>[a(_,{modelValue:e.value.search.mobile,"onUpdate:modelValue":l[6]||(l[6]=r=>e.value.search.mobile=r),placeholder:"请输入手机号",clearable:"",onKeydown:l[7]||(l[7]=P(r=>d(),["enter"])),onClear:l[8]||(l[8]=r=>d())},null,8,["modelValue"])]),_:2},1536),[[S,!t]]),y(a(b,null,{default:o(()=>[a(X,{modelValue:e.value.search.sex,"onUpdate:modelValue":l[9]||(l[9]=r=>e.value.search.sex=r),onChange:l[10]||(l[10]=r=>d())},{default:o(()=>[a(w,{label:""},{default:o(()=>[s(" 全部 ")]),_:1}),a(w,{label:1},{default:o(()=>[s(" 男 ")]),_:1}),a(w,{label:0},{default:o(()=>[s(" 女 ")]),_:1}),a(w,{label:2},{default:o(()=>[s(" 保密 ")]),_:1})]),_:1},8,["modelValue"])]),_:2},1536),[[S,!t]]),a(b,null,{default:o(()=>[a(v,{type:"primary",onClick:l[11]||(l[11]=r=>d())},{icon:o(()=>[a(C,{name:"i-ep:search"})]),default:o(()=>[s(" 筛选 ")]),_:1}),a(v,{onClick:K},{icon:o(()=>[Pe]),default:o(()=>[s(" 重置 ")]),_:1}),a(v,{link:"",onClick:g},{icon:o(()=>[a(C,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[s(" "+M(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(ee,{"border-style":"dashed"}),a(D,{wrap:""},{default:o(()=>[a(v,{type:"primary",size:"default",onClick:O},{icon:o(()=>[a(C,{name:"i-ep:plus"})]),default:o(()=>[s(" 新增用户 ")]),_:1})]),_:1}),y((c(),p(te,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:H,onSelectionChange:l[12]||(l[12]=t=>e.value.batch.selectionDataList=t)},{default:o(()=>[e.value.batch.enable?(c(),p(m,{key:0,type:"selection",align:"center",fixed:""})):k("",!0),a(m,{prop:"account",sortable:"",label:"帐号"}),a(m,{prop:"name",label:"姓名",width:"100",align:"center"},{default:o(({row:t})=>[a(x,{class:"mx-1"},{default:o(()=>[s(M(t.name?t.name:"暂无数据"),1)]),_:2},1024)]),_:1}),a(m,{prop:"sex",label:"性别",width:"100",align:"center"},{default:o(t=>[t.row.sex===1?(c(),p(V,{key:0,type:"success",size:"small"},{default:o(()=>[s(" 男 ")]),_:1})):t.row.sex===0?(c(),p(V,{key:1,type:"warning",size:"small"},{default:o(()=>[s(" 女 ")]),_:1})):(c(),p(V,{key:2,type:"info",size:"small"},{default:o(()=>[s(" 保密 ")]),_:1}))]),_:1}),a(m,{prop:"role",align:"center",width:"150",label:"角色"},{default:o(({row:t})=>[a(x,{class:"mx-1"},{default:o(()=>[s(M(t.role?t.role:"暂无数据"),1)]),_:2},1024)]),_:1}),a(m,{prop:"mobile",label:"手机号",width:"150",align:"center"},{default:o(({row:t})=>[a(x,{class:"mx-1"},{default:o(()=>[s(M(t.phoneNumber?t.phoneNumber:"暂无数据"),1)]),_:2},1024)]),_:1}),a(m,{label:"状态",width:"100",align:"center"},{default:o(t=>[a(ae,{modelValue:t.row.active,"onUpdate:modelValue":g=>t.row.active=g,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>J(t.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1}),a(m,{label:"操作",width:"200",align:"center",fixed:"right"},{default:o(t=>[a(D,null,{default:o(()=>[a(v,{type:"primary",size:"small",plain:"",onClick:g=>j(t.row)},{default:o(()=>[s(" 编辑 ")]),_:2},1032,["onClick"]),a(le,{onCommand:g=>W(g,t.row)},{dropdown:o(()=>[a(oe,null,{default:o(()=>[a(B,{command:"assignRoles"},{default:o(()=>[s(" 分配角色 ")]),_:1}),a(B,{command:"delete",divided:""},{default:o(()=>[s(" 删除 ")]),_:1})]),_:1})]),default:o(()=>[a(v,{size:"small"},{default:o(()=>[s(" 更多操作 "),a(C,{name:"i-ep:arrow-down",class:"el-icon--right"})]),_:1})]),_:2},1032,["onCommand"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ie,e.value.loading]]),a(ne,{"current-page":h(f).page,total:h(f).total,"page-size":h(f).size,"page-sizes":h(f).sizes,layout:h(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:d,onSizeChange:A},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(c(),p(Ce,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":l[13]||(l[13]=t=>e.value.formModeProps.visible=t),row:e.value.formModeProps.row,mode:e.value.formMode,onSuccess:u},null,8,["id","modelValue","row","mode"])):k("",!0),e.value.editProps.visible?(c(),p(ye,{key:1,id:e.value.editProps.id,modelValue:e.value.editProps.visible,"onUpdate:modelValue":l[14]||(l[14]=t=>e.value.editProps.visible=t),row:e.value.editProps,onSuccess:u},null,8,["id","modelValue","row"])):k("",!0)],2)}}});typeof N=="function"&&N(R);const Ne=Ee(R,[["__scopeId","data-v-3f47e947"]]);export{Ne as default};
