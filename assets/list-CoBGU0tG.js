
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as re}from"./index-C63Ompon.js";import{f as de,r as k,y as ce,X as $,h as d,aj as ue,o as m,c as pe,A as p,a as t,w as l,b as E,ak as I,i as D,B as w,au as S,c9 as T,k as f,l as M,cm as N,ai as z,H as ve,bG as ge,bE as me,_ as fe,d as P}from"./index-Bp4Fvijc.js";import _e from"./index-BSRp5kwz.js";import he from"./index-C4_MBWcv.js";import{a as _}from"./setting_basisDictionary-DOEnRX-o.js";import{u as ye}from"./usePagination-CofL5ZMG.js";const be=h=>(ge("data-v-234a2f85"),h=h(),me(),h),Ce={class:"absolute-container"},ke={class:"page-main"},Ee={class:"custom-tree-node"},Ie=["title"],De={class:"code"},we={class:"actions"},Se={class:"dictionary-container"},Ne={class:"dictionary-container"},ze=be(()=>p("div",{class:"empty"}," 请在左侧新增或选择一个字典 ",-1)),Ve=[ze],R=de({name:"SettingBasisDictionaryList",__name:"list",setup(h){const V=k(),i=k({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),{pagination:c,getParams:U,onSizeChange:A,onCurrentChange:G,onSortChange:J}=ye();c.value.size=20,c.value.sizes=[20,50,100];const O=k(),n=k({loading:!1,search:{dictionaryId:"",title:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:""}});function y(){i.value.loading=!0,n.value.search.dictionaryId="",_.list().then(e=>{i.value.tree=e.data,i.value.loading=!1})}ce(()=>{y()}),$(()=>i.value.search,e=>{V.value.filter(e)});function j(e,a){return e?a.label.includes(e):!0}function L(e){i.value.currentData=e,i.value.dialog.parentId=(e==null?void 0:e.id)??"",i.value.dialog.id="",i.value.dialog.visible=!0}function F(e,a){i.value.currentNode=e,i.value.currentData=a,i.value.row=JSON.stringify(a),i.value.dialog.parentId=e.parent.data.id??"",i.value.dialog.id=a.id,i.value.dialog.visible=!0}function H(e,a){N.confirm(`确认删除「${a.chineseName}」吗？`,"确认信息").then(()=>{_.delete(a.id).then(()=>{z.success({message:"删除成功",center:!0});const s=e.parent,r=s.data.children||s.data,b=r.findIndex(C=>C.id===a.id);r.splice(b,1),i.value.tree=[...i.value.tree]})})}function X(e){c.value.page=1,n.value.search.dictionaryId=e.id}$(()=>n.value.search.dictionaryId,()=>{u()});function u(){n.value.loading=!0;const e={...U(),id:n.value.search.dictionaryId};_.itemList(e).then(a=>{n.value.loading=!1,n.value.dataList=a.data.records,n.value.dataList.forEach(s=>{s.enableLoading=!1}),c.value.total=Number.parseInt(a.data.total)})}function q(e){A(e).then(()=>u())}function K(e=1){G(e).then(()=>u())}function Q({prop:e,order:a}){J(e,a).then(()=>u())}function W(){n.value.dialog.id="",n.value.dialog.visible=!0}function Y(e){n.value.row=JSON.stringify(e),n.value.dialog.id=e.id,n.value.dialog.visible=!0}function Z(e){N.confirm(`确认删除「${e.chineseName}」吗？`,"确认信息").then(()=>{_.itemDelete(e.id).then(()=>{u(),z.success({message:"删除成功",center:!0})})}).catch(()=>{})}function ee(e){N.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{_.itemDelete(e.map(a=>a.id)).then(()=>{u(),z.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(e,a)=>{const s=d("ElButton"),r=ve,b=d("ElButtonGroup"),C=d("ElInput"),ae=d("ElTree"),te=d("ElScrollbar"),ie=d("ElSpace"),g=d("ElTableColumn"),ne=d("ElTag"),le=d("ElTable"),oe=d("ElPagination"),se=re,x=ue("loading");return m(),pe("div",Ce,[p("div",ke,[t(se,{"hide-left-side-toggle":""},{leftSide:l(()=>[t(b,{class:"btns"},{default:l(()=>[t(s,{type:"primary",class:"add",onClick:a[0]||(a[0]=o=>L())},{default:l(()=>[E(" 新增字典 ")]),_:1}),t(s,{onClick:y},{icon:l(()=>[t(r,{name:"i-ep:refresh"})]),_:1})]),_:1}),t(C,{modelValue:i.value.search,"onUpdate:modelValue":a[1]||(a[1]=o=>i.value.search=o),placeholder:"请输入关键词筛选字典",clearable:"",class:"search"},null,8,["modelValue"]),t(te,{class:"tree"},{default:l(()=>[I((m(),D(ae,{ref_key:"dictionaryRef",ref:V,data:i.value.tree,"filter-node-method":j,"default-expand-all":"",onNodeClick:X},{default:l(({node:o,data:v})=>[p("div",Ee,[p("div",{class:"label",title:o.label},w(v.chineseName),9,Ie),p("div",De,w(v.englishName),1),p("div",we,[t(b,null,{default:l(()=>[t(s,{type:"primary",plain:"",size:"default",onClick:S(B=>L(v),["stop"])},{icon:l(()=>[t(r,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),t(s,{type:"info",plain:"",size:"default",onClick:S(B=>F(o,v),["stop"])},{icon:l(()=>[t(r,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),t(s,{type:"danger",plain:"",size:"default",onClick:S(B=>H(o,v),["stop"])},{icon:l(()=>[t(r,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[x,i.value.loading]])]),_:1})]),default:l(()=>[I(p("div",Se,[t(ie,{wrap:""},{default:l(()=>[t(s,{type:"primary",onClick:W},{icon:l(()=>[t(r,{name:"i-ep:plus"})]),_:1}),t(s,{type:"danger",disabled:!n.value.selectionDataList.length,onClick:a[2]||(a[2]=o=>ee(n.value.selectionDataList))},{icon:l(()=>[t(r,{name:"i-ep:delete"})]),_:1},8,["disabled"]),t(C,{modelValue:n.value.search.title,"onUpdate:modelValue":a[3]||(a[3]=o=>n.value.search.title=o),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),t(s,{onClick:u},{icon:l(()=>[t(r,{name:"i-ep:search"})]),_:1})]),_:1}),I((m(),D(le,{ref_key:"dictionaryItemRef",ref:O,data:n.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:Q,onSelectionChange:a[4]||(a[4]=o=>n.value.selectionDataList=o)},{default:l(()=>[t(g,{type:"selection",align:"center",fixed:""}),t(g,{prop:"chineseName",label:"中文名称"}),t(g,{prop:"englishName",label:"英文名称"}),t(g,{label:"键值",align:"center",width:"150"},{default:l(o=>[t(ne,{type:"info"},{default:l(()=>[E(w(o.row.code),1)]),_:2},1024)]),_:1}),t(g,{label:"操作",width:"200",align:"center"},{default:l(o=>[t(s,{type:"primary",size:"small",plain:"",onClick:v=>Y(o.row)},{default:l(()=>[E(" 编辑 ")]),_:2},1032,["onClick"]),t(s,{type:"danger",size:"small",plain:"",onClick:v=>Z(o.row)},{default:l(()=>[E(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[x,n.value.loading]]),t(oe,{"current-page":f(c).page,total:f(c).total,"page-size":f(c).size,"page-sizes":f(c).sizes,layout:f(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:q,onCurrentChange:K},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[T,n.value.search.dictionaryId]]),I(p("div",Ne,Ve,512),[[T,!n.value.search.dictionaryId]])]),_:1}),i.value.dialog.visible?(m(),D(_e,{key:0,id:i.value.dialog.id,modelValue:i.value.dialog.visible,"onUpdate:modelValue":a[5]||(a[5]=o=>i.value.dialog.visible=o),row:i.value.row,"parent-id":i.value.dialog.parentId,tree:i.value.tree,onAddNode:y,onEditNode:y},null,8,["id","modelValue","row","parent-id","tree"])):M("",!0),n.value.dialog.visible?(m(),D(he,{key:1,id:n.value.dialog.id,modelValue:n.value.dialog.visible,"onUpdate:modelValue":a[6]||(a[6]=o=>n.value.dialog.visible=o),"dictionary-id":n.value.search.dictionaryId,tree:i.value.tree,row:n.value.row,onSuccess:u},null,8,["id","modelValue","dictionary-id","tree","row"])):M("",!0)])])}}});typeof P=="function"&&P(R);const Pe=fe(R,[["__scopeId","data-v-234a2f85"]]);export{Pe as default};
