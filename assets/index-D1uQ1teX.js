
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{n as m,f as N,r as l,p as P,aD as w,h as r,aE as S,ai as j,k as s,o as f,c as _,a as n,w as i,A as v,B as E,ay as G,a0 as O,a1 as T,l as $,i as q,b as z,_ as A}from"./index-CeJVNZ3l.js";import{a as K}from"./menu-CrKF0d3b.js";import{a as H}from"./setting_permissions-DUgtDp94.js";const k={list:a=>m.get("setting/role/list",{params:a,baseURL:"/mock/"}),detail:a=>m.get("setting/role/detail",{params:{id:a},baseURL:"/mock/"}),create:a=>m.post("setting/role/create",a,{baseURL:"/mock/"}),edit:a=>m.post("setting/role/edit",a,{baseURL:"/mock/"}),delete:a=>m.post("setting/role/delete",{id:a},{baseURL:"/mock/"})},J={class:"custom-tree-node"},Q={class:"menu"},W={class:"permission"},X=N({__name:"index",props:{id:{default:""}},setup(a,{expose:C}){const R=a,p=l(!1),d=l(),g=l(),b=l([]),h=l([]),t=l({id:R.id,role:"",menu:[],permission:[]}),V=l({role:[{required:!0,message:"请输入角色吗",trigger:"blur"}]});P(async()=>{t.value.id!==""&&await D();const o=await K.list({type:"normal"});b.value=o.data;const{data:e}=await H.list();h.value=e,p.value=!1});async function D(){p.value=!0;const o=await k.detail(t.value.id);p.value=!1,t.value=o.data}function x(o){return h.value.filter(e=>o===e.menuId)}return C({submit(){return t.value.menu=g.value.getCheckedKeys(!1),new Promise(o=>{t.value.id===""?d.value&&d.value.validate(e=>{e&&k.create(t.value).then(()=>{w.success({message:"模拟新增成功",center:!0}),o()})}):d.value&&d.value.validate(e=>{e&&k.edit(t.value).then(()=>{w.success({message:"模拟编辑成功",center:!0}),o()})})})}}),(o,e)=>{const I=r("ElInput"),y=r("ElFormItem"),U=r("ElCheckbox"),F=r("ElCheckboxGroup"),L=r("el-tree"),B=r("ElForm"),M=S("loading");return j((f(),_("div",null,[n(B,{ref_key:"formRef",ref:d,model:s(t),rules:s(V),"label-width":"120px","label-suffix":"："},{default:i(()=>[n(y,{label:"角色码",prop:"role"},{default:i(()=>[n(I,{modelValue:s(t).role,"onUpdate:modelValue":e[0]||(e[0]=u=>s(t).role=u),placeholder:"请输入角色码"},null,8,["modelValue"])]),_:1}),n(y,{label:"角色码",prop:"role"},{default:i(()=>[n(L,{ref_key:"treeRef",ref:g,data:s(b),style:{width:"100%"},"default-checked-keys":s(t).menu,"default-expanded-keys":[],"node-key":"id","show-checkbox":"","default-expand-all":"","highlight-current":"",border:""},{default:i(({data:u})=>[v("div",J,[v("div",Q,E(u.meta.title),1),v("div",W,[x(u.id).length?(f(),_("div",{key:0,class:"permissions",onClick:e[2]||(e[2]=G(()=>{},["stop"]))},[n(F,{modelValue:s(t).permission,"onUpdate:modelValue":e[1]||(e[1]=c=>s(t).permission=c)},{default:i(()=>[(f(!0),_(O,null,T(x(u.id),c=>(f(),q(U,{key:c.Permission,value:c.id},{default:i(()=>[z(E(c.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue"])])):$("",!0)])])]),_:1},8,["data","default-checked-keys"])]),_:1})]),_:1},8,["model","rules"])])),[[M,s(p)]])}}}),Y=A(X,[["__scopeId","data-v-5c6e4c7e"]]),ae=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{Y as D,k as a,ae as i};
