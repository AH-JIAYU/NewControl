
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{f as N,m as F,u as pe,o as u,c as T,E as fe,p as A,a,l as V,M as H,y as O,r as ge,q as ve,G,s as _e,h as s,ap as he,w as o,aA as B,ai as k,b as r,H as be,i as v,k as C,aF as D,ao as L,e as Ee,at as we,au as Ce,aE as I,_ as ye,d as K}from"./index-Bfo1XFaq.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-BzMt01dH.js";import{a as S}from"./index.vue_vue_type_script_setup_true_lang-CBXvJ4Id.js";import{u as xe}from"./usePagination-BzZXPjtz.js";import{u as ke}from"./useTabbar-D5RiH4_Q.js";import"./setting_role-Cyya1FWj.js";const Se={key:0,class:"absolute bottom-0 left-0 w-full translate-y-1/2 text-center"},Ve=N({name:"SearchBar",__name:"index",props:F({showToggle:{type:Boolean,default:!0},background:{type:Boolean,default:!1}},{fold:{type:Boolean,default:!0},foldModifiers:{}}),emits:F(["toggle"],["update:fold"]),setup(_,{emit:c}){const $=c,p=pe(_,"fold");function y(){p.value=!p.value,$("toggle",p.value)}return(h,z)=>{const e=O;return u(),T("div",{class:H(["relative",{"py-4":h.showToggle,"px-4 bg-[var(--g-bg)] transition":h.background}])},[fe(h.$slots,"default",{fold:p.value,toggle:y}),h.showToggle?(u(),T("div",Se,[A("button",{class:"h-5 inline-flex cursor-pointer select-none items-center border-size-0 rounded bg-[var(--g-bg)] px-2 text-xs font-medium outline-none",onClick:y},[a(e,{name:p.value?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])])])):V("",!0)],2)}}}),$e=_=>(we("data-v-ae6a6462"),_=_(),Ce(),_),ze=$e(()=>A("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),j=N({name:"SettingUserList",__name:"list",setup(_){const{pagination:c,getParams:$,onSizeChange:p,onCurrentChange:y,onSortChange:h}=xe(),z=ke(),e=ge({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:""},search:{account:"",name:"",mobile:"",sex:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});ve(()=>{m(),e.value.formMode==="router"&&G.on("get-data-list",()=>{m()})}),_e(()=>{e.value.formMode==="router"&&G.off("get-data-list")});function m(){e.value.loading=!0;const l={...$(),...e.value.search.account&&{account:e.value.search.account},...e.value.search.name&&{name:e.value.search.name},...e.value.search.mobile&&{mobile:e.value.search.mobile},...e.value.search.sex!==""&&{sex:e.value.search.sex}};S.list(l).then(t=>{e.value.loading=!1,e.value.dataList=t.data.list,e.value.dataList.forEach(E=>{E.statusLoading=!1}),c.value.total=t.data.total})}function q(){Object.assign(e.value.search,{account:"",name:"",mobile:"",sex:""}),m()}function J(l){p(l).then(()=>m())}function d(l=1){y(l).then(()=>m())}function Q({prop:l,order:t}){h(l,t).then(()=>m())}function W(){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0)}function X(l){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerEdit",params:{id:l.id}}):(e.value.formModeProps.id=l.id,e.value.formModeProps.visible=!0)}function Y(l){return new Promise(t=>{D.confirm(`确认${l.status?"禁用":"启用"}「${l.account}」吗？`,"确认信息").then(()=>{l.statusLoading=!0,S.changeStatus({id:l.id,status:!l.status}).then(()=>(l.statusLoading=!1,L.success({message:`模拟${l.status?"禁用":"启用"}成功`,center:!0}),t(!0))).catch(()=>(l.statusLoading=!1,t(!1)))}).catch(()=>t(!1))})}function Z(l){D.confirm(`确认将「${l.account}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{S.passwordReset(l.id).then(()=>{L.success({message:"模拟重置成功",center:!0})})}).catch(()=>{})}function ee(l){D.confirm(`确认删除「${l.account}」用户吗？`,"确认信息").then(()=>{S.delete(l.id).then(()=>{m(),L.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}function ae(l,t){switch(l){case"resetPassword":Z(t);break;case"delete":ee(t);break}}return(l,t)=>{const E=s("ElInput"),w=s("ElFormItem"),M=s("ElRadioButton"),te=s("ElRadioGroup"),x=O,f=s("ElButton"),oe=s("ElForm"),le=Ve,ne=s("ElDivider"),U=s("ElSpace"),g=s("ElTableColumn"),P=s("ElTag"),se=s("ElSwitch"),R=s("ElDropdownItem"),re=s("ElDropdownMenu"),ie=s("ElDropdown"),ue=s("ElTable"),de=s("ElPagination"),ce=Ee,me=he("loading");return u(),T("div",{class:H({"absolute-container":e.value.tableAutoHeight})},[a(ce,null,{default:o(()=>[a(le,{"show-toggle":!1},{default:o(({fold:n,toggle:b})=>[a(oe,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[a(w,null,{default:o(()=>[a(E,{modelValue:e.value.search.account,"onUpdate:modelValue":t[0]||(t[0]=i=>e.value.search.account=i),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:t[1]||(t[1]=B(i=>d(),["enter"])),onClear:t[2]||(t[2]=i=>d())},null,8,["modelValue"])]),_:1}),k(a(w,null,{default:o(()=>[a(E,{modelValue:e.value.search.name,"onUpdate:modelValue":t[3]||(t[3]=i=>e.value.search.name=i),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:t[4]||(t[4]=B(i=>d(),["enter"])),onClear:t[5]||(t[5]=i=>d())},null,8,["modelValue"])]),_:2},1536),[[I,!n]]),k(a(w,null,{default:o(()=>[a(E,{modelValue:e.value.search.mobile,"onUpdate:modelValue":t[6]||(t[6]=i=>e.value.search.mobile=i),placeholder:"请输入手机号",clearable:"",onKeydown:t[7]||(t[7]=B(i=>d(),["enter"])),onClear:t[8]||(t[8]=i=>d())},null,8,["modelValue"])]),_:2},1536),[[I,!n]]),k(a(w,null,{default:o(()=>[a(te,{modelValue:e.value.search.sex,"onUpdate:modelValue":t[9]||(t[9]=i=>e.value.search.sex=i),onChange:t[10]||(t[10]=i=>d())},{default:o(()=>[a(M,{label:""},{default:o(()=>[r(" 全部 ")]),_:1}),a(M,{label:1},{default:o(()=>[r(" 男 ")]),_:1}),a(M,{label:0},{default:o(()=>[r(" 女 ")]),_:1}),a(M,{label:2},{default:o(()=>[r(" 保密 ")]),_:1})]),_:1},8,["modelValue"])]),_:2},1536),[[I,!n]]),a(w,null,{default:o(()=>[a(f,{type:"primary",onClick:t[11]||(t[11]=i=>d())},{icon:o(()=>[a(x,{name:"i-ep:search"})]),default:o(()=>[r(" 筛选 ")]),_:1}),a(f,{onClick:q},{icon:o(()=>[ze]),default:o(()=>[r(" 重置 ")]),_:1}),a(f,{link:"",onClick:b},{icon:o(()=>[a(x,{name:n?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[r(" "+be(n?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(ne,{"border-style":"dashed"}),a(U,{wrap:""},{default:o(()=>[a(f,{type:"primary",size:"default",onClick:W},{icon:o(()=>[a(x,{name:"i-ep:plus"})]),default:o(()=>[r(" 新增用户 ")]),_:1}),e.value.batch.enable?(u(),v(f,{key:0,size:"default",disabled:!e.value.batch.selectionDataList.length},{default:o(()=>[r(" 批量操作 ")]),_:1},8,["disabled"])):V("",!0)]),_:1}),k((u(),v(ue,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:Q,onSelectionChange:t[12]||(t[12]=n=>e.value.batch.selectionDataList=n)},{default:o(()=>[e.value.batch.enable?(u(),v(g,{key:0,type:"selection",align:"center",fixed:""})):V("",!0),a(g,{prop:"account",sortable:"",label:"帐号"}),a(g,{prop:"name",label:"姓名",width:"100",align:"center"}),a(g,{prop:"sex",label:"性别",width:"100",align:"center"},{default:o(n=>[n.row.sex===1?(u(),v(P,{key:0,type:"success",size:"small"},{default:o(()=>[r(" 男 ")]),_:1})):n.row.sex===0?(u(),v(P,{key:1,type:"warning",size:"small"},{default:o(()=>[r(" 女 ")]),_:1})):(u(),v(P,{key:2,type:"info",size:"small"},{default:o(()=>[r(" 保密 ")]),_:1}))]),_:1}),a(g,{prop:"mobile",label:"手机号",width:"150",align:"center"}),a(g,{label:"状态",width:"100",align:"center"},{default:o(n=>[a(se,{modelValue:n.row.status,"onUpdate:modelValue":b=>n.row.status=b,loading:n.row.statusLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>Y(n.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),a(g,{label:"操作",width:"200",align:"center",fixed:"right"},{default:o(n=>[a(U,null,{default:o(()=>[a(f,{type:"primary",size:"small",plain:"",onClick:b=>X(n.row)},{default:o(()=>[r(" 编辑 ")]),_:2},1032,["onClick"]),a(ie,{onCommand:b=>ae(b,n.row)},{dropdown:o(()=>[a(re,null,{default:o(()=>[a(R,{command:"resetPassword"},{default:o(()=>[r(" 重置密码 ")]),_:1}),a(R,{command:"delete",divided:""},{default:o(()=>[r(" 删除 ")]),_:1})]),_:1})]),default:o(()=>[a(f,{size:"small"},{default:o(()=>[r(" 更多操作 "),a(x,{name:"i-ep:arrow-down",class:"el-icon--right"})]),_:1})]),_:2},1032,["onCommand"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[me,e.value.loading]]),a(de,{"current-page":C(c).page,total:C(c).total,"page-size":C(c).size,"page-sizes":C(c).sizes,layout:C(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:d,onSizeChange:J},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(u(),v(Me,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":t[13]||(t[13]=n=>e.value.formModeProps.visible=n),mode:e.value.formMode,onSuccess:m},null,8,["id","modelValue","mode"])):V("",!0)],2)}}});typeof K=="function"&&K(j);const Ue=ye(j,[["__scopeId","data-v-ae6a6462"]]);export{Ue as default};
