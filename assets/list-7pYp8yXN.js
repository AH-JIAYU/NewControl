
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{f as ue,I as ce,r as C,p as pe,y as me,h as i,aj as de,o as h,c as P,a,w as l,$ as ve,a0 as fe,b as s,B as d,ak as ge,i as k,k as f,l as he,L as _e,cm as z,ai as x,H as be,e as ye,bG as we,bE as Ce,A as ke,_ as Ee,d as N}from"./index-vWDRJyOK.js";import{_ as Se,a as Le,b as Me}from"./index.vue_vue_type_style_index_0_lang-BTvHaXFn.js";import{_ as Ve}from"./index.vue_vue_type_script_setup_true_lang-BdEdDQBn.js";import{_ as Pe}from"./index.vue_vue_type_script_setup_true_lang-ZzER-CuU.js";import{u as ze,a as _}from"./index-DL834JjR.js";import{u as xe}from"./usePagination-CTTZw-6T.js";import{u as Ne}from"./useTabbar-CWQZ5nVv.js";import"./vue.runtime.esm-bundler-DsknqAH1.js";import"./country-DbI8Kqug.js";import"./setting_basisDictionary-S0Zq-z81.js";import"./setting_versionManagement-CXUszLjW.js";const Ue=b=>(we("data-v-9f07c6c7"),b=b(),Ce(),b),Ie=Ue(()=>ke("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),U=ue({name:"SurveyBillManagementList",__name:"list",setup(b){const I=ce(),H=ze(),E=C(),{pagination:m,onSizeChange:$,onCurrentChange:B,onSortChange:D}=xe(),T=Ne(),S=pe(),L=C([{label:"等级名称",prop:"a",sortable:!0,disableCheck:!1,checked:!0}]),e=C({loading:!1,tableAutoHeight:!1,border:!0,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:"",row:""},search:{page:1,limit:10,version:"",name:"",id:""},batch:{enable:!1,selectionDataList:[]},dataList:[]});me(()=>{c()});async function c(){e.value.loading=!0,E.value=await H.getVersion,_.list({page:1,limit:10}).then(o=>{e.value.loading=!1,e.value.dataList=o.data.result,m.value.total=Number.parseInt(o.data.total)})}function A(){e.value.loading=!0,_.list(e.value.search).then(o=>{e.value.loading=!1,e.value.dataList=o.data,m.value.total=Number.parseInt(o.data.total)})}function F(){Object.assign(e.value.search,{page:1,limit:10,version:"",name:"",id:""}),c()}function R(o){$(o).then(()=>c())}function O(o=1){B(o).then(()=>c())}async function j(){try{const{data:o}=await _.export({page:1,limit:10,id:"",name:"",versionId:""}),n=new Blob([o],{type:"application/octet-stream"}),g=window.URL.createObjectURL(n),p=document.createElement("a");p.href=g,p.download="租户管理.xlsx",p.click(),window.URL.revokeObjectURL(g)}catch(o){console.error("导出失败",o)}}async function J(o){z.confirm(`确认将状态修改成「${o.active===1?"启用":"禁用"}」吗？`,"确认信息").then(async()=>{const{status:n}=await _.edit({id:o.id,active:o.active,phone:o.phone,email:o.email});n===1&&x.success({message:"修改「状态」成功",center:!0}),c()}).catch(()=>{c()})}function q(){e.value.formModeProps.id="",e.value.formModeProps.visible=!0,e.value.formModeProps.row=JSON.stringify({})}function G(o){e.value.formMode==="router"?S.settings.tabbar.enable&&S.settings.tabbar.mergeTabsBy!=="activeMenu"?T.open({name:"multilevel_menu_examplePermissionsEdit",params:{id:o.id,menulev:o.menuLevel,path:o.path,auths:JSON.stringify(o.auths)}}):I.push({name:"multilevel_menu_examplePermissionsEdit",params:{id:o.id,menulev:o.menuLevel,path:o.path,auths:JSON.stringify(o.auths)}}):(e.value.formModeProps.id=o.id,e.value.formModeProps.row=JSON.stringify(o),e.value.formModeProps.visible=!0)}function Q(o){z.confirm(`确认将「${o.name}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{_.reset({id:o.id}).then(()=>{x.success({message:"重置成功",center:!0}),c()})}).catch(()=>{})}return(o,n)=>{const g=i("ElInput"),p=i("ElFormItem"),K=i("el-option"),W=i("el-select"),M=be,w=i("ElButton"),X=i("ElForm"),Y=Ve,Z=i("ElDivider"),y=i("el-button"),ee=Se,te=Le,ae=Me,oe=i("el-row"),V=i("el-table-column"),r=i("ElTableColumn"),le=i("ElSwitch"),ne=i("ElTable"),ie=i("ElPagination"),se=ye,re=de("loading");return h(),P("div",{class:_e({"absolute-container":e.value.tableAutoHeight})},[a(se,null,{default:l(()=>[a(Y,{"show-toggle":!1},{default:l(({fold:t,toggle:v})=>[a(X,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[a(p,null,{default:l(()=>[a(g,{modelValue:e.value.search.id,"onUpdate:modelValue":n[0]||(n[0]=u=>e.value.search.id=u),placeholder:"租户ID",clearable:""},null,8,["modelValue"])]),_:1}),a(p,null,{default:l(()=>[a(g,{modelValue:e.value.search.name,"onUpdate:modelValue":n[1]||(n[1]=u=>e.value.search.name=u),placeholder:"租户名称",clearable:""},null,8,["modelValue"])]),_:1}),a(p,null,{default:l(()=>[a(W,{modelValue:e.value.search.version,"onUpdate:modelValue":n[2]||(n[2]=u=>e.value.search.version=u),placeholder:"请选择版本"},{default:l(()=>[(h(!0),P(ve,null,fe(E.value,u=>(h(),k(K,{key:u.id,label:u.name,value:u.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,null,{default:l(()=>[a(w,{type:"primary",onClick:n[3]||(n[3]=u=>A())},{icon:l(()=>[a(M,{name:"i-ep:search"})]),default:l(()=>[s(" 筛选 ")]),_:1}),a(w,{onClick:F},{icon:l(()=>[Ie]),default:l(()=>[s(" 重置 ")]),_:1}),a(w,{disabled:"",link:"",onClick:v},{icon:l(()=>[a(M,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[s(" "+d(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(Z,{"border-style":"dashed"}),a(oe,null,{default:l(()=>[a(ee,null,{default:l(()=>[a(y,{size:"default",type:"primary",onClick:q},{default:l(()=>[s(" 新增 ")]),_:1})]),_:1}),a(ae,null,{default:l(()=>[a(y,{size:"default",onClick:j},{default:l(()=>[s(" 导出 ")]),_:1}),a(te,{border:e.value.border,"onUpdate:border":n[4]||(n[4]=t=>e.value.border=t),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":n[5]||(n[5]=t=>e.value.tableAutoHeight=t),checkList:e.value.checkList,"onUpdate:checkList":n[6]||(n[6]=t=>e.value.checkList=t),columns:L.value,"onUpdate:columns":n[7]||(n[7]=t=>L.value=t),"line-height":e.value.lineHeight,"onUpdate:lineHeight":n[8]||(n[8]=t=>e.value.lineHeight=t),stripe:e.value.stripe,"onUpdate:stripe":n[9]||(n[9]=t=>e.value.stripe=t),style:{"margin-left":"12px"},onQueryData:c},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),ge((h(),k(ne,{border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:f(D),onSelectionChange:n[10]||(n[10]=t=>e.value.batch.selectionDataList=t)},{default:l(()=>[a(V,{align:"center",prop:"a","show-overflow-tooltip":"",type:"selection"}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"id",width:"80",label:"租户ID"}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"companyType",label:"账户类型"},{default:l(({row:t})=>[s(d(t.companyType?t.companyType:"暂无数据"),1)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"name",label:"用户名"},{default:l(({row:t})=>[s(d(t.name?t.name:"暂无数据"),1)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"companyName",label:"公司名称"},{default:l(({row:t})=>[s(d(t.companyName?t.companyName:"暂无数据"),1)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"version",label:"版本"}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"countryName",label:"国家"},{default:l(({row:t})=>[s(d(t.countryName?t.countryName:"暂无数据"),1)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"email",label:"邮箱"},{default:l(({row:t})=>[s(d(t.email?t.email:"暂无数据"),1)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"phone",label:"手机号码"},{default:l(({row:t})=>[s(d(t.phone?t.phone:"暂无数据"),1)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"date",label:"期限"}),a(r,{align:"center","show-overflow-tooltip":"",prop:"active",label:"状态"},{default:l(({row:t})=>[a(le,{modelValue:t.active,"onUpdate:modelValue":v=>t.active=v,"inline-prompt":"","active-text":"开启","inactive-text":"关闭","active-value":1,"inactive-value":2,onChange:v=>J(t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(r,{"show-overflow-tooltip":"",align:"center",prop:"registerFrom",label:"租户来源"}),a(V,{align:"center",prop:"i",label:"操作","show-overflow-tooltip":"",width:"180"},{default:l(({row:t})=>[a(y,{size:"small",plain:"",type:"primary",onClick:v=>Q(t)},{default:l(()=>[s(" 重置密码 ")]),_:2},1032,["onClick"]),a(y,{size:"small",plain:"",type:"primary",onClick:v=>G(t)},{default:l(()=>[s(" 编辑 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","size","stripe","data","onSortChange"])),[[re,e.value.loading]]),a(ie,{"current-page":f(m).page,total:f(m).total,"page-size":f(m).size,"page-sizes":f(m).sizes,layout:f(m).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:R,onCurrentChange:O},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(h(),k(Pe,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":n[11]||(n[11]=t=>e.value.formModeProps.visible=t),row:e.value.formModeProps.row,mode:e.value.formMode,onSuccess:c},null,8,["id","modelValue","row","mode"])):he("",!0)],2)}}});typeof N=="function"&&N(U);const qe=Ee(U,[["__scopeId","data-v-9f07c6c7"]]);export{qe as default};
