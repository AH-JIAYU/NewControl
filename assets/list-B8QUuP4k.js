
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{f as $,J as V,y as z,r as H,p as D,z as h,q as N,h as m,o as p,c as P,a as t,w as o,b as u,k as l,a0 as A,a1 as F,B as y,i as C,l as U,M as q,aF as J,an as R,x as j,e as G,_ as K}from"./index-SmQBdNpn.js";import{_ as O}from"./index.vue_vue_type_script_setup_true_lang-BSazZ2Eg.js";import{a as E}from"./setting_permissions-BOIfAGee.js";import{a as Q}from"./menu-C5eNBjxQ.js";import{u as W}from"./useTabbar-Cb7c54ye.js";import"./index-ee59zww4.js";import"./sortable.esm-BS5toX6s.js";const X=$({name:"SettingPermissionsList",__name:"list",setup(Y){const b=V(),g=W(),d=z(),e=H({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,menulev:1,id:""},search:{title:""},dataList:[]});D(()=>{c(),e.value.formMode==="router"&&h.on("get-data-list",()=>{c()})}),N(()=>{e.value.formMode==="router"&&h.off("get-data-list")});function M(a,n){a.forEach(s=>{s.children&&s.children.length>0&&(s.auths=M(s.children,n));const _=n.filter(r=>r.menu===s.name);return s.auths=_,[]})}async function c(){e.value.loading=!0;const a=await E.list(),n=await Q.list({type:"flat"});M(n.data,a.data),e.value.dataList=n.data,e.value.loading=!1}function x(){e.value.formMode==="router"?d.settings.tabbar.enable&&d.settings.tabbar.mergeTabsBy!=="activeMenu"?g.open({name:"multilevel_menu_examplePermissionsCreate"}):b.push({name:"multilevel_menu_examplePermissionsCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0)}function k(a){e.value.formMode==="router"?d.settings.tabbar.enable&&d.settings.tabbar.mergeTabsBy!=="activeMenu"?g.open({name:"multilevel_menu_examplePermissionsEdit",params:{id:a.id,menulev:a.menuLevel}}):b.push({name:"multilevel_menu_examplePermissionsEdit",params:{id:a.id,menulev:a.menuLevel}}):(e.value.formModeProps.id=a.id,e.value.formModeProps.menulev=a.menuLevel,e.value.formModeProps.visible=!0)}function B(a){J.confirm(`确认删除「${a.title}」吗？`,"确认信息").then(()=>{E.delete(a.id).then(()=>{c()})}).catch(()=>{})}return(a,n)=>{const s=R,_=j,r=m("ElButton"),L=m("ElSpace"),v=m("ElTableColumn"),S=m("el-tag"),T=m("ElTable"),w=G;return p(),P("div",{class:q({"absolute-container":l(e).tableAutoHeight})},[t(s,{title:"权限管理管理"}),t(w,null,{default:o(()=>[t(L,{wrap:""},{default:o(()=>[t(r,{type:"primary",size:"default",onClick:x},{icon:o(()=>[t(_,{name:"i-ep:plus"})]),default:o(()=>[u(" 新增按钮权限 ")]),_:1})]),_:1}),t(T,{data:l(e).dataList,"row-key":"id",stripe:"","highlight-current-row":"","default-expand-all":"",border:"",style:{lineHeight:"normal"}},{default:o(()=>[t(v,{prop:"meta.title",width:"300",label:"模块"}),t(v,{label:"权限"},{default:o(({row:i})=>[(p(!0),P(A,null,F(i.auths,f=>(p(),C(S,{key:f.id,type:"primary"},{default:o(()=>[u(y(f.label),1)]),_:2},1024))),128))]),_:1}),t(v,{label:"操作",width:"250",align:"center",fixed:"right"},{default:o(i=>[t(r,{type:"primary",size:"small",plain:"",onClick:f=>k(i.row)},{default:o(()=>[u(" 编辑 ")]),_:2},1032,["onClick"]),t(r,{type:"danger",size:"small",plain:"",onClick:f=>B(i.row)},{default:o(()=>[u(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),u(" "+y(l(e).formModeProps.menulev),1)]),_:1}),l(e).formMode==="dialog"||l(e).formMode==="drawer"?(p(),C(O,{key:0,id:l(e).formModeProps.id,modelValue:l(e).formModeProps.visible,"onUpdate:modelValue":n[0]||(n[0]=i=>l(e).formModeProps.visible=i),menulev:l(e).formModeProps.menulev,mode:l(e).formMode,onSuccess:c},null,8,["id","modelValue","menulev","mode"])):U("",!0)],2)}}}),ne=K(X,[["__scopeId","data-v-a3efc7c1"]]);export{ne as default};
