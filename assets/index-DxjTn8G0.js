
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{ah as g,ag as j,r as c,g as B,f as R,y as J,ak as E,h as p,ai as L,aj as z,k as e,o as d,c as S,a as o,w as s,b as A,$ as I,a0 as D,i as m,l as V,_ as G}from"./index-CrP1nLrF.js";import{u as H}from"./country-Cj7GgPlG.js";import{a as K}from"./setting_versionManagement-D2DYteCj.js";const q={list:r=>g.post("tenant-control/getTenant",r),create:r=>g.post("tenant-control/insertTenant",r),edit:r=>g.post("tenant-control/updateTenantStatus",r),export:r=>g.post("tenant-control/exportTenantList",r,{responseType:"blob"}),reset:r=>g.post("tenant-user/resetPassword",r)},Q=j("version",()=>{const r=c([]),N=B(async()=>{if(r.value.length)return r.value;const{data:v}=await K.list();return v});return{versionMenu:r,getVersion:N}}),W=Q,F="创建完成后，请告知用户初始密码：123456",X=R({__name:"index",props:["id","row"],setup(r,{expose:N}){const v=r,P=H(),M=W(),i=c(!1),y=c(),l=c({id:v.id,name:"",password:"123456",country:"",companyName:"",taxID:"",legalPersonName:"",phone:"",email:"",version:"",active:1,registerType:"phone",type:"company"}),f=JSON.parse(v.row),U=c([]),T=c([]),O=c({name:[{required:!0,message:"请输入用户名",trigger:"blur"}],companyName:[{required:!0,message:"请输入公司名称",trigger:"blur"}],country:[{required:!0,message:"请选择国家",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],type:[{required:!0,message:"请选择账户类型",trigger:"blur"}]});J(async()=>{i.value=!0,U.value=await P.getCountry,T.value=await M.getVersion,v.id&&(l.value=JSON.parse(v.row)),l.value.type="company",i.value=!1});function $(){l.value.registerType=l.value.country==="CN"?"phone":"email"}return N({submit(){return new Promise(k=>{if(l.value.id==="")y.value&&y.value.validate(t=>{t&&(i.value=!0,delete l.value.id,q.create(l.value).then(b=>{const{status:n,error:u}=b;E({type:n===1?"success":"warning",message:n===1?"新增成功":u,center:!0}),i.value=!1,k()}))});else{const{active:t,phone:b,email:n,id:u}=l.value,_={active:t,phone:b,email:n,id:u};y.value&&y.value.validate(w=>{w&&(i.value=!0,q.edit(_).then(h=>{const{status:x,error:C}=h;E({type:x===1?"success":"warning",message:x===1?"编辑成功":C,center:!0}),i.value=!1,k()}))})}})}}),(k,t)=>{const b=p("el-text"),n=p("ElFormItem"),u=p("ElInput"),_=p("el-option"),w=p("el-select"),h=p("el-switch"),x=p("ElForm"),C=L("loading");return z((d(),S("div",null,[o(x,{ref_key:"formRef",ref:y,model:e(l),rules:e(O),"label-width":"120px","label-suffix":"："},{default:s(()=>[o(n,{label:"账户类型",prop:""},{default:s(()=>[o(b,null,{default:s(()=>[A("公司")]),_:1})]),_:1}),o(n,{label:"用户名",prop:"name"},{default:s(()=>[o(u,{modelValue:e(l).name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(l).name=a),disabled:e(f).id,placeholder:"请输入用户名"},null,8,["modelValue","disabled"])]),_:1}),o(n,{label:"国家",prop:"country"},{default:s(()=>[o(w,{modelValue:e(l).country,"onUpdate:modelValue":t[1]||(t[1]=a=>e(l).country=a),disabled:e(f).id,"value-key":"",placeholder:"请选择国家",clearable:"",filterable:""},{default:s(()=>[(d(!0),S(I,null,D(e(U),a=>(d(),m(_,{key:a.id,label:a.chineseName,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(l).type==="company"?(d(),m(n,{key:0,label:"公司名称",prop:"companyName"},{default:s(()=>[o(u,{modelValue:e(l).companyName,"onUpdate:modelValue":t[2]||(t[2]=a=>e(l).companyName=a),disabled:e(f).id,placeholder:"请输入公司名称"},null,8,["modelValue","disabled"])]),_:1})):V("",!0),e(l).type==="company"?(d(),m(n,{key:1,label:"公司税号"},{default:s(()=>[o(u,{modelValue:e(l).taxID,"onUpdate:modelValue":t[3]||(t[3]=a=>e(l).taxID=a),disabled:e(f).id,placeholder:"请输入公司税号"},null,8,["modelValue","disabled"])]),_:1})):V("",!0),e(l).type==="company"?(d(),m(n,{key:2,label:"法人姓名"},{default:s(()=>[o(u,{modelValue:e(l).legalPersonName,"onUpdate:modelValue":t[4]||(t[4]=a=>e(l).legalPersonName=a),disabled:e(f).id,placeholder:"请输入法人姓名"},null,8,["modelValue","disabled"])]),_:1})):V("",!0),e(l).country==="CN"?(d(),m(n,{key:3,label:"手机号码",prop:"phone"},{default:s(()=>[o(u,{modelValue:e(l).phone,"onUpdate:modelValue":t[5]||(t[5]=a=>e(l).phone=a),placeholder:"请输入手机号码"},null,8,["modelValue"])]),_:1})):V("",!0),e(l).country!=="CN"?(d(),m(n,{key:4,label:"电子邮箱",prop:"email"},{default:s(()=>[o(u,{modelValue:e(l).email,"onUpdate:modelValue":t[6]||(t[6]=a=>e(l).email=a),placeholder:"请输入电子邮箱"},null,8,["modelValue"])]),_:1})):V("",!0),o(n,{label:"初始密码",prop:"password"},{default:s(()=>[o(u,{modelValue:F,"onUpdate:modelValue":t[7]||(t[7]=a=>F=a),disabled:"",placeholder:"请输入登录密码"})]),_:1}),o(n,{label:"版本分配",prop:"version"},{default:s(()=>[o(w,{modelValue:e(l).version,"onUpdate:modelValue":t[8]||(t[8]=a=>e(l).version=a),disabled:e(f).id,placeholder:"请选择版本",onChange:$},{default:s(()=>[(d(!0),S(I,null,D(e(T),a=>(d(),m(_,{key:a.id,label:a.name,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(n,{label:"租户状态",prop:"active"},{default:s(()=>[o(h,{modelValue:e(l).active,"onUpdate:modelValue":t[9]||(t[9]=a=>e(l).active=a),"inline-prompt":"","active-text":"开启","inactive-text":"关闭","active-value":2,"inactive-value":1},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])),[[C,e(i)]])}}}),Y=G(X,[["__scopeId","data-v-28d65184"]]),ae=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{Y as D,q as a,ae as i,W as u};
