
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{f as N,J as V,A as H,r as z,q as J,G as P,s as A,h as u,o as m,c as h,a as t,w as s,b as c,k as o,a0 as D,a1 as O,l as y,i as C,M as w,aF as F,ao as U,an as q,y as G,e as R,H as j,_ as K}from"./index-DEkb9qM_.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-DrhRkfwK.js";import{a as E}from"./setting_permissions-BCPo_SsI.js";import{a as W}from"./menu-CQf6QKmq.js";import{u as X}from"./useTabbar-Cnq8Zw8L.js";import"./index-U95OIL4-.js";import"./sortable.esm-BS5toX6s.js";const Y={key:0},Z=N({name:"SettingPermissionsList",__name:"list",setup(I){const g=V(),b=X(),d=H(),e=z({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,menulev:1,path:"",auths:[],id:""},search:{title:""},dataList:[]});J(()=>{p(),e.value.formMode==="router"&&P.on("get-data-list",()=>{p()})}),A(()=>{e.value.formMode==="router"&&P.off("get-data-list")});function M(a,n){a.forEach(l=>{l.children&&l.children.length>0&&(l.auths=M(l.children,n));const _=n.filter(r=>r.menu===l.name);return l.auths=_,[]})}async function p(){e.value.loading=!0;const a=await E.list(),n=await W.list({type:"normal"});M(n.data,a.data),e.value.dataList=n.data,e.value.loading=!1}function k(){e.value.formMode==="router"?d.settings.tabbar.enable&&d.settings.tabbar.mergeTabsBy!=="activeMenu"?b.open({name:"multilevel_menu_examplePermissionsCreate",params:{menulev:3}}):g.push({name:"multilevel_menu_examplePermissionsCreate",params:{menulev:3}}):(e.value.formModeProps.id="",e.value.formModeProps.menulev=3,e.value.formModeProps.visible=!0)}function x(a){e.value.formMode==="router"?d.settings.tabbar.enable&&d.settings.tabbar.mergeTabsBy!=="activeMenu"?b.open({name:"multilevel_menu_examplePermissionsEdit",params:{id:a.id,menulev:a.menuLevel,path:a.path,auths:JSON.stringify(a.auths)}}):g.push({name:"multilevel_menu_examplePermissionsEdit",params:{id:a.id,menulev:a.menuLevel,path:a.path,auths:JSON.stringify(a.auths)}}):(e.value.formModeProps.id=a.id,e.value.formModeProps.menulev=a.menuLevel,e.value.formModeProps.path=a.path,e.value.formModeProps.auths=JSON.stringify(a.auths),e.value.formModeProps.visible=!0)}function S(a){F.confirm(`确认删除「${a.title}」吗？`,"确认信息").then(()=>{E.delete(a.id).then(()=>{p(),U.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}return(a,n)=>{const l=q,_=G,r=u("ElButton"),B=u("ElSpace"),v=u("ElTableColumn"),L=u("el-tag"),T=u("ElTable"),$=R;return m(),h("div",{class:w({"absolute-container":o(e).tableAutoHeight})},[t(l,{title:"权限管理管理"}),t($,null,{default:s(()=>[t(B,{wrap:""},{default:s(()=>[t(r,{type:"primary",size:"default",onClick:k},{icon:s(()=>[t(_,{name:"i-ep:plus"})]),default:s(()=>[c(" 新增按钮权限 ")]),_:1})]),_:1}),t(T,{data:o(e).dataList,"row-key":"id",stripe:"","highlight-current-row":"","default-expand-all":"",border:"",style:{lineHeight:"normal"}},{default:s(()=>[t(v,{prop:"meta.title",width:"300",label:"模块"}),t(v,{label:"权限"},{default:s(({row:i})=>[(m(!0),h(D,null,O(i.auths,f=>(m(),C(L,{key:f.id,type:"primary"},{default:s(()=>[c(j(f.label),1)]),_:2},1024))),128))]),_:1}),t(v,{label:"操作",width:"250",align:"center",fixed:"right"},{default:s(i=>[i.row.menuLevel>2?(m(),h("div",Y,[t(r,{type:"primary",size:"small",plain:"",onClick:f=>x(i.row)},{default:s(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),t(r,{type:"danger",size:"small",plain:"",onClick:f=>S(i.row)},{default:s(()=>[c(" 删除 ")]),_:2},1032,["onClick"])])):y("",!0)]),_:1})]),_:1},8,["data"])]),_:1}),o(e).formMode==="dialog"||o(e).formMode==="drawer"?(m(),C(Q,{key:0,id:o(e).formModeProps.id,modelValue:o(e).formModeProps.visible,"onUpdate:modelValue":n[0]||(n[0]=i=>o(e).formModeProps.visible=i),path:o(e).formModeProps.path,auths:o(e).formModeProps.auths,menulev:o(e).formModeProps.menulev,mode:o(e).formMode,onSuccess:p},null,8,["id","modelValue","path","auths","menulev","mode"])):y("",!0)],2)}}}),ie=K(Z,[["__scopeId","data-v-80d3c799"]]);export{ie as default};
