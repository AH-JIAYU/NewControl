
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{g as re,r as ue,q as de,D as I,I as me,i as s,s as ce,o as m,c as pe,a,w as l,av as V,t as M,b as i,G as x,j as p,n as P,l as h,Q as fe,cm as U,E as L,M as ve,e as ge,bG as _e,bE as be,F as he,c9 as k,_ as Ee,d as N}from"./index-zX-UbP25.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-PdwUtJmW.js";import{_ as Ce}from"./index.vue_vue_type_script_setup_true_lang-sDFHF-VX.js";import Me from"./index-BdsVG_vE.js";import{a as S}from"./setting_user-DZ7tjb3u.js";import{u as ye}from"./usePagination-DxUxEec2.js";import{u as Ve}from"./useTabbar-BxJ-ZlRa.js";import"./index.vue_vue_type_script_setup_true_lang-DSmA9se7.js";import"./setting_role-DJGbejQF.js";const xe=E=>(_e("data-v-362d30c8"),E=E(),be(),E),Pe=xe(()=>he("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),R=re({name:"SettingUserList",__name:"list",setup(E){const{pagination:f,onSizeChange:T,onCurrentChange:G,onSortChange:F}=ye(),z=Ve(),e=ue({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:"",row:""},editProps:{visible:!1,id:""},search:{account:"",name:"",mobile:"",sex:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});de(()=>{u(),e.value.formMode==="router"&&I.on("get-data-list",()=>{u()})}),me(()=>{e.value.formMode==="router"&&I.off("get-data-list")});function u(){e.value.loading=!0,S.list().then(n=>{var o;e.value.loading=!1,e.value.dataList=n.data,f.value.total=(o=n.data)==null?void 0:o.length,e.value.dataList.forEach(_=>{_.statusLoading=!1})})}function K(){Object.assign(e.value.search,{account:"",name:"",mobile:"",sex:""}),u()}function O(n){T(n).then(()=>u())}function d(n=1){G(n).then(()=>u())}function j({prop:n,order:o}){F(n,o).then(()=>u())}function A(){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0)}function H(n){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerEdit",params:{id:n.id}}):(e.value.formModeProps.id=n.id,e.value.formModeProps.row=JSON.stringify(n),e.value.formModeProps.visible=!0)}function q(n){return new Promise(o=>{U.confirm(`确认${n.active?"禁用":"启用"}「${n.account}」吗？`,"确认信息").then(()=>{e.value.loading=!0,S.edit({id:n.id,account:null,name:null,sex:null,phoneNumber:null,active:!n.active}).then(()=>(L.success({message:`${n.active?"禁用":"启用"}成功`,center:!0}),u(),e.value.loading=!1,o(!0))).catch(()=>(e.value.loading=!1,o(!1)))}).catch(()=>o(!1))})}function J(n){e.value.editProps=n,e.value.editProps.visible=!0}function Q(n){U.confirm(`确认删除「${n.account}」用户吗？`,"确认信息").then(()=>{S.delete({id:n.id}).then(()=>{u(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}function W(n,o){switch(n){case"assignRoles":J(o);break;case"delete":Q(o);break}}return(n,o)=>{const _=s("ElInput"),b=s("ElFormItem"),w=s("ElRadioButton"),X=s("ElRadioGroup"),C=ve,v=s("ElButton"),Y=s("ElForm"),Z=we,ee=s("ElDivider"),$=s("ElSpace"),c=s("ElTableColumn"),D=s("el-text"),y=s("ElTag"),ae=s("ElSwitch"),B=s("ElDropdownItem"),oe=s("ElDropdownMenu"),le=s("ElDropdown"),te=s("ElTable"),ne=s("ElPagination"),se=ge,ie=ce("loading");return m(),pe("div",{class:fe({"absolute-container":e.value.tableAutoHeight})},[a(se,null,{default:l(()=>[a(Z,{"show-toggle":!1},{default:l(({fold:t,toggle:g})=>[a(Y,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[a(b,null,{default:l(()=>[a(_,{modelValue:e.value.search.account,"onUpdate:modelValue":o[0]||(o[0]=r=>e.value.search.account=r),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:o[1]||(o[1]=V(r=>d(),["enter"])),onClear:o[2]||(o[2]=r=>d())},null,8,["modelValue"])]),_:1}),M(a(b,null,{default:l(()=>[a(_,{modelValue:e.value.search.name,"onUpdate:modelValue":o[3]||(o[3]=r=>e.value.search.name=r),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:o[4]||(o[4]=V(r=>d(),["enter"])),onClear:o[5]||(o[5]=r=>d())},null,8,["modelValue"])]),_:2},1536),[[k,!t]]),M(a(b,null,{default:l(()=>[a(_,{modelValue:e.value.search.mobile,"onUpdate:modelValue":o[6]||(o[6]=r=>e.value.search.mobile=r),placeholder:"请输入手机号",clearable:"",onKeydown:o[7]||(o[7]=V(r=>d(),["enter"])),onClear:o[8]||(o[8]=r=>d())},null,8,["modelValue"])]),_:2},1536),[[k,!t]]),M(a(b,null,{default:l(()=>[a(X,{modelValue:e.value.search.sex,"onUpdate:modelValue":o[9]||(o[9]=r=>e.value.search.sex=r),onChange:o[10]||(o[10]=r=>d())},{default:l(()=>[a(w,{label:""},{default:l(()=>[i(" 全部 ")]),_:1}),a(w,{label:1},{default:l(()=>[i(" 男 ")]),_:1}),a(w,{label:0},{default:l(()=>[i(" 女 ")]),_:1}),a(w,{label:2},{default:l(()=>[i(" 保密 ")]),_:1})]),_:1},8,["modelValue"])]),_:2},1536),[[k,!t]]),a(b,null,{default:l(()=>[a(v,{type:"primary",onClick:o[11]||(o[11]=r=>d())},{icon:l(()=>[a(C,{name:"i-ep:search"})]),default:l(()=>[i(" 筛选 ")]),_:1}),a(v,{onClick:K},{icon:l(()=>[Pe]),default:l(()=>[i(" 重置 ")]),_:1}),a(v,{link:"",onClick:g},{icon:l(()=>[a(C,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[i(" "+x(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(ee,{"border-style":"dashed"}),a($,{wrap:""},{default:l(()=>[a(v,{type:"primary",size:"default",onClick:A},{icon:l(()=>[a(C,{name:"i-ep:plus"})]),default:l(()=>[i(" 新增用户 ")]),_:1})]),_:1}),M((m(),p(te,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:j,onSelectionChange:o[12]||(o[12]=t=>e.value.batch.selectionDataList=t)},{default:l(()=>[e.value.batch.enable?(m(),p(c,{key:0,type:"selection",align:"center",fixed:""})):P("",!0),a(c,{prop:"account",sortable:"",label:"帐号"}),a(c,{prop:"name",label:"姓名",width:"100",align:"center"},{default:l(({row:t})=>[a(D,{class:"mx-1"},{default:l(()=>[i(x(t.name?t.name:"暂无数据"),1)]),_:2},1024)]),_:1}),a(c,{prop:"sex",label:"性别",width:"100",align:"center"},{default:l(t=>[t.row.sex===1?(m(),p(y,{key:0,type:"success",size:"small"},{default:l(()=>[i(" 男 ")]),_:1})):t.row.sex===0?(m(),p(y,{key:1,type:"warning",size:"small"},{default:l(()=>[i(" 女 ")]),_:1})):(m(),p(y,{key:2,type:"info",size:"small"},{default:l(()=>[i(" 保密 ")]),_:1}))]),_:1}),a(c,{prop:"mobile",label:"手机号",width:"150",align:"center"},{default:l(({row:t})=>[a(D,{class:"mx-1"},{default:l(()=>[i(x(t.phoneNumber?t.phoneNumber:"暂无数据"),1)]),_:2},1024)]),_:1}),a(c,{label:"状态",width:"100",align:"center"},{default:l(t=>[a(ae,{modelValue:t.row.active,"onUpdate:modelValue":g=>t.row.active=g,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>q(t.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1}),a(c,{label:"操作",width:"200",align:"center",fixed:"right"},{default:l(t=>[a($,null,{default:l(()=>[a(v,{type:"primary",size:"small",plain:"",onClick:g=>H(t.row)},{default:l(()=>[i(" 编辑 ")]),_:2},1032,["onClick"]),a(le,{onCommand:g=>W(g,t.row)},{dropdown:l(()=>[a(oe,null,{default:l(()=>[a(B,{command:"assignRoles"},{default:l(()=>[i(" 分配角色 ")]),_:1}),a(B,{command:"delete",divided:""},{default:l(()=>[i(" 删除 ")]),_:1})]),_:1})]),default:l(()=>[a(v,{size:"small"},{default:l(()=>[i(" 更多操作 "),a(C,{name:"i-ep:arrow-down",class:"el-icon--right"})]),_:1})]),_:2},1032,["onCommand"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ie,e.value.loading]]),a(ne,{"current-page":h(f).page,total:h(f).total,"page-size":h(f).size,"page-sizes":h(f).sizes,layout:h(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:d,onSizeChange:O},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(m(),p(Ce,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":o[13]||(o[13]=t=>e.value.formModeProps.visible=t),row:e.value.formModeProps.row,mode:e.value.formMode,onSuccess:u},null,8,["id","modelValue","row","mode"])):P("",!0),e.value.editProps.visible?(m(),p(Me,{key:1,id:e.value.editProps.id,modelValue:e.value.editProps.visible,"onUpdate:modelValue":o[14]||(o[14]=t=>e.value.editProps.visible=t),row:e.value.editProps,onSuccess:u},null,8,["id","modelValue","row"])):P("",!0)],2)}}});typeof N=="function"&&N(R);const Ne=Ee(R,[["__scopeId","data-v-362d30c8"]]);export{Ne as default};
