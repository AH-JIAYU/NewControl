
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{ah as f,ag as $,r as i,g as j,f as B,y as P,ai as T,h as m,aj as R,ak as J,k as e,o as u,c as h,a as r,w as n,$ as E,a0 as C,i as _,l as U,_ as L}from"./index-qQLkOm5f.js";import{u as z}from"./country-CHzaIAOf.js";import{a as A}from"./setting_versionManagement-Bq-mJafT.js";const F={list:o=>f.post("tenant-control/get/getTenant",o),create:o=>f.post("tenant-control/insert/insertTenant",o),edit:o=>f.post("tenant-control/update/updateTenantStatus",o),export:o=>f.post("tenant-control/export/exportTenantList",o),reset:o=>f.post("tenant-user/update/resetPassword",o)},G=$("version",()=>{const o=i([]),y=j(async()=>{if(o.value.length)return o.value;const{data:d}=await A.list();return d});return{versionMenu:o,getVersion:y}}),H=G,N="创建完成后，请告知用户初始密码：123456",K=B({__name:"index",props:["id","row"],setup(o,{expose:y}){const d=o,q=z(),I=H(),V=i(!1),c=i(),l=i({id:d.id,name:"",country:"",phone:"",email:"",version:"",active:1,registerType:"phone"}),v=JSON.parse(d.row),k=i([]),S=i([]),D=i({name:[{required:!0,message:"请输入用户名",trigger:"blur"}],country:[{required:!0,message:"请选择国家",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],registerType:[{required:!0,message:"请选择注册方式",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}]});return P(async()=>{V.value=!0,k.value=await q.getCountry,S.value=await I.getVersion,d.id&&(l.value=JSON.parse(d.row)),V.value=!1}),y({submit(){return new Promise(w=>{if(l.value.id==="")c.value&&c.value.validate(a=>{l.value.registerType=l.value.country==="CN"?"phone":"email",a&&F.create(l.value).then(()=>{T.success({message:"新增成功",center:!0}),w()})});else{const{active:a,phone:p,email:s,id:g}=l.value,b={active:a,phone:p,email:s,id:g};c.value&&c.value.validate(x=>{x&&F.edit(b).then(()=>{T.success({message:"编辑成功",center:!0}),w()})})}})}}),(w,a)=>{const p=m("ElInput"),s=m("ElFormItem"),g=m("el-option"),b=m("el-select"),x=m("el-switch"),M=m("ElForm"),O=R("loading");return J((u(),h("div",null,[r(M,{ref_key:"formRef",ref:c,model:e(l),rules:e(D),"label-width":"120px","label-suffix":"："},{default:n(()=>[r(s,{label:"用户名",prop:"name"},{default:n(()=>[r(p,{modelValue:e(l).name,"onUpdate:modelValue":a[0]||(a[0]=t=>e(l).name=t),disabled:e(v).id,placeholder:"请输入用户名"},null,8,["modelValue","disabled"])]),_:1}),r(s,{label:"国家",prop:"country"},{default:n(()=>[r(b,{modelValue:e(l).country,"onUpdate:modelValue":a[1]||(a[1]=t=>e(l).country=t),disabled:e(v).id,"value-key":"",placeholder:"请选择国家",clearable:"",filterable:""},{default:n(()=>[(u(!0),h(E,null,C(e(k).records,t=>(u(),_(g,{key:t.id,label:t.chineseName,value:t.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(v).registerType==="phone"?(u(),_(s,{key:0,label:"手机号码",prop:"phone"},{default:n(()=>[r(p,{modelValue:e(l).phone,"onUpdate:modelValue":a[2]||(a[2]=t=>e(l).phone=t),placeholder:"请输入手机号码"},null,8,["modelValue"])]),_:1})):U("",!0),e(v).registerType==="email"?(u(),_(s,{key:1,label:"电子邮箱",prop:"email"},{default:n(()=>[r(p,{modelValue:e(l).email,"onUpdate:modelValue":a[3]||(a[3]=t=>e(l).email=t),placeholder:"请输入电子邮箱"},null,8,["modelValue"])]),_:1})):U("",!0),r(s,{label:"初始密码",prop:"password"},{default:n(()=>[r(p,{modelValue:N,"onUpdate:modelValue":a[4]||(a[4]=t=>N=t),disabled:"",placeholder:"请输入登录密码"})]),_:1}),r(s,{label:"版本分配",prop:"version"},{default:n(()=>[r(b,{modelValue:e(l).version,"onUpdate:modelValue":a[5]||(a[5]=t=>e(l).version=t),disabled:e(v).id,placeholder:"请选择版本"},{default:n(()=>[(u(!0),h(E,null,C(e(S),t=>(u(),_(g,{key:t.id,label:t.name,value:t.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),r(s,{label:"租户状态",prop:"active"},{default:n(()=>[r(x,{modelValue:e(l).active,"onUpdate:modelValue":a[6]||(a[6]=t=>e(l).active=t),"inline-prompt":"","active-text":"开启","inactive-text":"关闭","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])),[[O,e(V)]])}}}),Q=L(K,[["__scopeId","data-v-63ab1bbb"]]),Z=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));export{Q as D,F as a,Z as i};
