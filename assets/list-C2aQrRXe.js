
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{g as O,N as D,x as J,a2 as $,r as j,q as H,D as y,I as z,i as m,s as U,o as l,c as _,a as i,w as r,b as h,t as A,l as o,j as p,a4 as q,a5 as F,n as g,Q as G,ap as Q,M as R,e as K,G as W,_ as X}from"./index-C3PJOLdt.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang-C1oj2P61.js";import Z from"./index-TK2wquED.js";import{a as I}from"./tenant_tenantPermission-DTCz8FND.js";import{u as ee}from"./tenantMenu-DM0cu3TL.js";import{u as te}from"./tenantButtonPermission-CM11j0rz.js";import{u as ae}from"./useTabbar-D5-A52A4.js";import"./index-NQL4KcsF.js";import"./tenant_tenantMenu-D1ZCS-tM.js";const oe={key:0},se=O({name:"TenantTenantPermissionList",__name:"list",setup(ne){const E=te(),S=ee(),k=D(),C=ae(),b=J();$("success",d);const e=j({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,menulev:1,path:"",auths:[],id:""},EditProps:{visible:!1},search:{title:""},dataList:[]});H(()=>{d(),e.value.formMode==="router"&&y.on("get-data-list",()=>{d()})}),z(()=>{e.value.formMode==="router"&&y.off("get-data-list")});function P(t,s){t.forEach(a=>{a.children&&a.children.length>0&&(a.auths=P(a.children,s));const u=s.filter(f=>f.menu===a.name);return a.auths=u,[]})}async function d(){e.value.loading=!0;const t=await I.list();E.tenantPermissions=t.data;const s=await S.gettenantMenu;if(P(s,t.data),e.value.dataList=s,e.value.loading=!1,e.value.formModeProps.id){const a=M(e.value.dataList,e.value.formModeProps.id);e.value.formModeProps.auths=JSON.stringify(a.auths)}}function M(t,s){for(const a of t){if(a.id===s)return a;if(a.children){const u=M(a.children,s);if(u)return u}}return null}function L(){e.value.EditProps.id=11,e.value.EditProps.visible=!0,e.value.EditProps.row=JSON.stringify({})}function x(t){e.value.formMode==="router"?b.settings.tabbar.enable&&b.settings.tabbar.mergeTabsBy!=="activeMenu"?C.open({name:"multilevel_menu_examplePermissionsEdit",params:{id:t.id,menulev:t.menuLevel,path:t.path,auths:JSON.stringify(t.auths)}}):k.push({name:"multilevel_menu_examplePermissionsEdit",params:{id:t.id,menulev:t.menuLevel,path:t.path,auths:JSON.stringify(t.auths)}}):(e.value.formModeProps.id=t.id,e.value.formModeProps.menulev=t.menuLevel,e.value.formModeProps.auths=JSON.stringify(t.auths),e.value.formModeProps.visible=!0)}return(t,s)=>{const a=Q,u=R,f=m("ElButton"),B=m("ElSpace"),c=m("ElTableColumn"),T=m("el-tag"),N=m("ElTable"),V=K,w=U("loading");return l(),_("div",{class:G({"absolute-container":o(e).tableAutoHeight})},[i(a,{title:"权限管理管理"}),i(V,null,{default:r(()=>[i(B,{wrap:""},{default:r(()=>[i(f,{type:"primary",size:"default",onClick:L},{icon:r(()=>[i(u,{name:"i-ep:plus"})]),default:r(()=>[h(" 新增按钮权限 ")]),_:1})]),_:1}),A((l(),p(N,{data:o(e).dataList,"row-key":"id",stripe:"","highlight-current-row":"","default-expand-all":"",border:"",style:{lineHeight:"normal"}},{default:r(()=>[i(c,{prop:"meta.title",width:"300",label:"模块"}),i(c,{label:"权限"},{default:r(({row:n})=>[(l(!0),_(q,null,F(n.auths,v=>(l(),p(T,{key:v.id,type:"primary"},{default:r(()=>[h(W(v.label),1)]),_:2},1024))),128))]),_:1}),i(c,{label:"操作",width:"250",align:"center",fixed:"right"},{default:r(n=>[n.row.menuLevel>2&&n.row.auths.length?(l(),_("div",oe,[i(f,{type:"primary",size:"small",plain:"",onClick:v=>x(n.row)},{default:r(()=>[h(" 详情 ")]),_:2},1032,["onClick"])])):g("",!0)]),_:1})]),_:1},8,["data"])),[[w,o(e).loading]])]),_:1}),o(e).formMode==="dialog"||o(e).formMode==="drawer"?(l(),p(Y,{key:0,id:o(e).formModeProps.id,modelValue:o(e).formModeProps.visible,"onUpdate:modelValue":s[0]||(s[0]=n=>o(e).formModeProps.visible=n),path:o(e).formModeProps.path,auths:o(e).formModeProps.auths,menulev:o(e).formModeProps.menulev,mode:o(e).formMode,onSuccess:d},null,8,["id","modelValue","path","auths","menulev","mode"])):g("",!0),o(e).EditProps.visible?(l(),p(Z,{key:1,modelValue:o(e).EditProps.visible,"onUpdate:modelValue":s[1]||(s[1]=n=>o(e).EditProps.visible=n),onSuccess:d},null,8,["modelValue"])):g("",!0)],2)}}}),ve=X(se,[["__scopeId","data-v-e16055aa"]]);export{ve as default};
