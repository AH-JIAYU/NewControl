
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{f as S,aF as q,r as s,q as G,ao as x,h as l,ap as U,ai as A,k as o,o as m,c as f,a as r,w as n,p,H as y,aA as H,a0 as K,a1 as L,l as T,i as $,b as j,_ as z}from"./index-DR6yxu20.js";import{a as _}from"./setting_role-5zZdImod.js";import{a as J}from"./setting_permissions-XKKZqIzY.js";const O={class:"custom-tree-node"},Q={class:"menu"},W={class:"permission"},X=S({__name:"index",props:["id"],setup(w,{expose:E}){const C=w,I=q(),c=s(!1),i=s(),v=s(),k=s([]),h=s([]),e=s({id:C.id,role:"",menuId:[],permission:[]}),V=s({role:[{required:!0,message:"请输入角色吗",trigger:"blur"}]});G(async()=>{e.value.id!==""&&await F(),k.value=I.routesRaw;const{data:a}=await J.list();h.value=a,c.value=!1});async function F(){c.value=!0;const a=await _.detail(e.value.id);c.value=!1,e.value=a.data}function b(a){return h.value.filter(t=>a===t.menuId)}return E({submit(){return e.value.menuId=v.value.getCheckedKeys(!1),new Promise(a=>{e.value.id===""?i.value&&i.value.validate(t=>{t&&_.create(e.value).then(()=>{x.success({message:"模拟新增成功",center:!0}),a()})}):i.value&&i.value.validate(t=>{t&&_.edit(e.value).then(()=>{x.success({message:"模拟编辑成功",center:!0}),a()})})})}}),(a,t)=>{const R=l("ElInput"),g=l("ElFormItem"),D=l("ElCheckbox"),B=l("ElCheckboxGroup"),N=l("el-tree"),M=l("ElForm"),P=U("loading");return A((m(),f("div",null,[r(M,{ref_key:"formRef",ref:i,model:o(e),rules:o(V),"label-width":"120px","label-suffix":"："},{default:n(()=>[r(g,{label:"角色码",prop:"role"},{default:n(()=>[r(R,{modelValue:o(e).role,"onUpdate:modelValue":t[0]||(t[0]=u=>o(e).role=u),placeholder:"请输入角色码"},null,8,["modelValue"])]),_:1}),r(g,{label:"权限"},{default:n(()=>[r(N,{ref_key:"treeRef",ref:v,data:o(k),style:{width:"100%"},"default-checked-keys":o(e).menuId,"default-expanded-keys":[],"node-key":"id","show-checkbox":"","default-expand-all":"","highlight-current":"",border:""},{default:n(({data:u})=>[p("div",O,[p("div",Q,y(u.meta.title),1),p("div",W,[b(u.id).length?(m(),f("div",{key:0,class:"permissions",onClick:t[2]||(t[2]=H(()=>{},["stop"]))},[r(B,{modelValue:o(e).permission,"onUpdate:modelValue":t[1]||(t[1]=d=>o(e).permission=d)},{default:n(()=>[(m(!0),f(K,null,L(b(u.id),d=>(m(),$(D,{key:d.Permission,value:d.key},{default:n(()=>[j(y(d.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue"])])):T("",!0)])])]),_:1},8,["data","default-checked-keys"])]),_:1})]),_:1},8,["model","rules"])])),[[P,o(c)]])}}}),te=z(X,[["__scopeId","data-v-a8cb819b"]]);export{te as default};
