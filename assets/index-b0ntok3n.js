
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{af as V,d as Z,m as w,r as b,n as G,u as H,c as Q,t as W,a as s,ai as X,o as m,b as q,aj as ee,i as a,e as F,w as t,f as o,g as p,Y as h,Z as E,cn as le,ak as C,x as I,y as U,I as ae}from"./index-B0r-lXgm.js";import{u as te}from"./supplieMenu-9A9rnSoh.js";const $={list:()=>V.get("supplier-button/getButton"),create:d=>V.post("supplier-button/insertButton",d),edit:d=>V.post("supplier-button/updateButton",d),delete:d=>V.delete(`supplier-button/updateButton/${d}`)},ue={style:{float:"left"}},oe={style:{float:"right","font-size":"13px",color:"var(--el-text-color-secondary)"}},ne=Z({__name:"index",props:w(["id","path","keys","row","menulev"],{modelValue:{default:!1},modelModifiers:{}}),emits:w(["success"],["update:modelValue"]),setup(d,{emit:j}){const k=b(!1),f=d,z=j,A=te(),N=G("success"),_=b(),e=b({menulev:f.menulev,keys:f.keys||[],menuData:[],choiceMenuData:[],queryForm:{id:f.id||""}}),L=b({menu:[{required:!0,message:"请选择路由地址",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"blur"}],name:[{required:!0,message:"请输入key标识",trigger:"blur"}],label:[{required:!0,message:"请输入名称",trigger:"blur"}]}),D=H(d,"modelValue"),O=Q(()=>f.id===""?"新增权限":"编辑权限"),R=b([{value:3,label:"三级导航"},{value:4,label:"内置页面"}]);function v(n,u){const i=[];function y(r){if(Array.isArray(r))for(const c of r)c.menuLevel===u&&i.push(c),Array.isArray(c.children)&&y(c.children)}return y(n),i}function x(n){n===1?e.value.choiceMenuData=v(e.value.menuData,1):n===2?e.value.choiceMenuData=v(e.value.menuData,2):n===3?e.value.choiceMenuData=v(e.value.menuData,3):e.value.choiceMenuData=v(e.value.menuData,4)}function K(n){const u=e.value.choiceMenuData.find(i=>i.path===n);e.value.keys=u.key,e.value.queryForm.menuId=u.id}function T(){e.value.queryForm.permissions=`${e.value.queryForm.menu}-${e.value.queryForm.type}-${e.value.queryForm.name}`,e.value.queryForm.id?_.value&&_.value.validate(n=>{n&&$.edit(e.value.queryForm).then(()=>{C.success({message:"编辑成功",center:!0}),N(),M()})}):_.value.validate(n=>{n&&(k.value=!0,$.create(e.value.queryForm).then(()=>{C.success({message:"新增成功",center:!0}),z("success"),M(),k.value=!1}))})}W(async()=>{e.value.queryForm.id!==""&&(e.value.queryForm=JSON.parse(f.row)),e.value.menuData=await A.getsupplieMenu,e.value.choiceMenuData=v(e.value.menuData,e.value.menulev)});function M(){D.value=!1}return(n,u)=>{const i=s("el-option"),y=s("el-select"),r=s("ElFormItem"),c=s("ElSelect"),g=s("el-radio-button"),Y=s("el-radio-group"),B=s("ElInput"),S=s("ElButton"),J=s("ElDialog"),P=X("loading");return m(),q("div",null,[ee((m(),F(J,{modelValue:D.value,"onUpdate:modelValue":u[6]||(u[6]=l=>D.value=l),title:a(O),width:"60%","close-on-click-modal":!1,"append-to-body":"","destroy-on-close":""},{footer:t(()=>[o(S,{size:"large",onClick:M},{default:t(()=>[p(" 取消 ")]),_:1}),o(S,{type:"primary",size:"large",onClick:T},{default:t(()=>[p(" 确定 ")]),_:1})]),default:t(()=>[o(a(le),{ref_key:"formRef",ref:_,inline:!0,rules:a(L),model:a(e).queryForm,"label-width":"120px","label-suffix":":"},{default:t(()=>[o(r,{label:"路由等级"},{default:t(()=>[o(y,{modelValue:a(e).menulev,"onUpdate:modelValue":u[0]||(u[0]=l=>a(e).menulev=l),disabled:!!a(e).id,placeholder:"Select",onChange:x},{default:t(()=>[(m(!0),q(h,null,E(a(R),l=>(m(),F(i,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(r,{label:"选择路由",prop:"menu"},{default:t(()=>[o(c,{modelValue:a(e).queryForm.menu,"onUpdate:modelValue":u[1]||(u[1]=l=>a(e).queryForm.menu=l),disabled:!!a(e).id,placeholder:"选择路由",onChange:K},{default:t(()=>[(m(!0),q(h,null,E(a(e).choiceMenuData,l=>(m(),F(i,{key:l.id,label:l.meta.title,value:l.path},{default:t(()=>[I("span",ue,U(l.meta.title),1),I("span",oe,U(l.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(r,{label:"类型",prop:"type"},{default:t(()=>[o(Y,{modelValue:a(e).queryForm.type,"onUpdate:modelValue":u[2]||(u[2]=l=>a(e).queryForm.type=l)},{default:t(()=>[o(g,{value:"get",label:"get"},{default:t(()=>[p(" 读 ")]),_:1}),o(g,{value:"insert",label:"insert"},{default:t(()=>[p(" 写 ")]),_:1}),o(g,{value:"update",label:"update"},{default:t(()=>[p(" 改 ")]),_:1}),o(g,{value:"delete",label:"delete"},{default:t(()=>[p(" 删 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(r,{label:"对应接口"},{default:t(()=>[o(y,{modelValue:a(e).queryForm.key,"onUpdate:modelValue":u[3]||(u[3]=l=>a(e).queryForm.key=l),disabled:!!a(e).id,placeholder:"Select",onChange:x},{default:t(()=>[(m(!0),q(h,null,E(a(e).keys,l=>(m(),F(i,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(r,{label:"权限KEY",prop:"name"},{default:t(()=>[o(B,{modelValue:a(e).queryForm.name,"onUpdate:modelValue":u[4]||(u[4]=l=>a(e).queryForm.name=l)},null,8,["modelValue"])]),_:1}),o(r,{label:"名称",prop:"label"},{default:t(()=>[o(B,{modelValue:a(e).queryForm.label,"onUpdate:modelValue":u[5]||(u[5]=l=>a(e).queryForm.label=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])),[[P,a(k)]])])}}}),re=ae(ne,[["__scopeId","data-v-fb3f275e"]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{re as E,$ as a,ie as i};
