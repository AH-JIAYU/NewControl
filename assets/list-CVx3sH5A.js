
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as se}from"./index-D8Hqa52n.js";import{d as de,r as E,t as re,R as B,a as r,ai as ce,o as m,b as ue,x as p,f as t,w as l,g as k,aj as I,e as w,y as D,au as S,c9 as T,i as f,j as M,cm as N,ak as z,E as pe,bG as ve,bE as ge,I as me,ag as R}from"./index-59jiekGF.js";import fe from"./index-BBZdJ5Dd.js";import _e from"./index-OdGMF28V.js";import{a as _}from"./setting_basisDictionary-CgjSekwa.js";import{u as he}from"./usePagination-BvAqffZ6.js";const ye=h=>(ve("data-v-60067d68"),h=h(),ge(),h),be={class:"absolute-container"},Ce={class:"page-main"},Ee={class:"custom-tree-node"},ke=["title"],Ie={class:"code"},we={class:"actions"},De={class:"dictionary-container"},Se={class:"dictionary-container"},Ne=ye(()=>p("div",{class:"empty"}," 请在左侧新增或选择一个字典 ",-1)),ze=[Ne],P=de({name:"basis_dictionary",__name:"list",setup(h){const V=E(),i=E({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),{pagination:c,getParams:Ve,onSizeChange:U,onCurrentChange:G,onSortChange:j}=he();c.value.size=20,c.value.sizes=[20,50,100];const A=E(),n=E({loading:!1,search:{dictionaryId:"",title:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:""}});function y(){i.value.loading=!0,n.value.search.dictionaryId="",_.list().then(e=>{i.value.tree=e.data,i.value.loading=!1})}re(()=>{y()}),B(()=>i.value.search,e=>{V.value.filter(e)});function J(e,a){return e?a.label.includes(e):!0}function L(e){i.value.currentData=e,i.value.dialog.parentId=(e==null?void 0:e.id)??"",i.value.dialog.id="",i.value.dialog.visible=!0}function O(e,a){i.value.currentNode=e,i.value.currentData=a,i.value.row=JSON.stringify(a),i.value.dialog.parentId=e.parent.data.id??"",i.value.dialog.id=a.id,i.value.dialog.visible=!0}function F(e,a){N.confirm(`确认删除「${a.chineseName}」吗？`,"确认信息").then(()=>{_.delete(a.id).then(()=>{z.success({message:"删除成功",center:!0});const s=e.parent,d=s.data.children||s.data,b=d.findIndex(C=>C.id===a.id);d.splice(b,1),i.value.tree=[...i.value.tree]})})}function q(e){c.value.page=1,n.value.search.dictionaryId=e.id}B(()=>n.value.search.dictionaryId,()=>{u()});function u(){n.value.loading=!0;const e={id:n.value.search.dictionaryId};_.itemList(e).then(a=>{n.value.loading=!1,n.value.dataList=a.data,n.value.dataList.forEach(s=>{s.enableLoading=!1}),c.value.total=Number.parseInt(a.data.total)})}function H(e){U(e).then(()=>u())}function K(e=1){G(e).then(()=>u())}function Q({prop:e,order:a}){j(e,a).then(()=>u())}function W(){n.value.dialog.id="",n.value.dialog.visible=!0}function X(e){n.value.row=JSON.stringify(e),n.value.dialog.id=e.id,n.value.dialog.visible=!0}function Y(e){N.confirm(`确认删除「${e.chineseName}」吗？`,"确认信息").then(()=>{_.itemDelete(e.id).then(()=>{u(),z.success({message:"删除成功",center:!0})})}).catch(()=>{})}function Z(e){N.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{_.itemDelete(e.map(a=>a.id)).then(()=>{u(),z.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(e,a)=>{const s=r("ElButton"),d=pe,b=r("ElButtonGroup"),C=r("ElInput"),ee=r("ElTree"),ae=r("ElScrollbar"),te=r("ElSpace"),g=r("ElTableColumn"),ie=r("ElTag"),ne=r("ElTable"),le=r("ElPagination"),oe=se,x=ce("loading");return m(),ue("div",be,[p("div",Ce,[t(oe,{"hide-left-side-toggle":""},{leftSide:l(()=>[t(b,{class:"btns"},{default:l(()=>[t(s,{type:"primary",class:"add",onClick:a[0]||(a[0]=o=>L())},{default:l(()=>[k(" 新增字典 ")]),_:1}),t(s,{onClick:y},{icon:l(()=>[t(d,{name:"i-ep:refresh"})]),_:1})]),_:1}),t(C,{modelValue:i.value.search,"onUpdate:modelValue":a[1]||(a[1]=o=>i.value.search=o),placeholder:"请输入关键词筛选字典",clearable:"",class:"search"},null,8,["modelValue"]),t(ae,{class:"tree"},{default:l(()=>[I((m(),w(ee,{ref_key:"dictionaryRef",ref:V,data:i.value.tree,"filter-node-method":J,"default-expand-all":"",onNodeClick:q},{default:l(({node:o,data:v})=>[p("div",Ee,[p("div",{class:"label",title:o.label},D(v.chineseName),9,ke),p("div",Ie,D(v.englishName),1),p("div",we,[t(b,null,{default:l(()=>[t(s,{type:"primary",plain:"",size:"default",onClick:S($=>L(v),["stop"])},{icon:l(()=>[t(d,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),t(s,{type:"info",plain:"",size:"default",onClick:S($=>O(o,v),["stop"])},{icon:l(()=>[t(d,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),t(s,{type:"danger",plain:"",size:"default",onClick:S($=>F(o,v),["stop"])},{icon:l(()=>[t(d,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[x,i.value.loading]])]),_:1})]),default:l(()=>[I(p("div",De,[t(te,{wrap:""},{default:l(()=>[t(s,{type:"primary",onClick:W},{icon:l(()=>[t(d,{name:"i-ep:plus"})]),_:1}),t(s,{type:"danger",disabled:!n.value.selectionDataList.length,onClick:a[2]||(a[2]=o=>Z(n.value.selectionDataList))},{icon:l(()=>[t(d,{name:"i-ep:delete"})]),_:1},8,["disabled"]),t(C,{modelValue:n.value.search.title,"onUpdate:modelValue":a[3]||(a[3]=o=>n.value.search.title=o),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),t(s,{onClick:u},{icon:l(()=>[t(d,{name:"i-ep:search"})]),_:1})]),_:1}),I((m(),w(ne,{ref_key:"dictionaryItemRef",ref:A,data:n.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:Q,onSelectionChange:a[4]||(a[4]=o=>n.value.selectionDataList=o)},{default:l(()=>[t(g,{type:"selection",align:"center",fixed:""}),t(g,{prop:"chineseName",label:"中文名称"}),t(g,{prop:"englishName",label:"英文名称"}),t(g,{label:"键值",align:"center",width:"150"},{default:l(o=>[t(ie,{type:"info"},{default:l(()=>[k(D(o.row.code),1)]),_:2},1024)]),_:1}),t(g,{label:"操作",width:"200",align:"center"},{default:l(o=>[t(s,{type:"primary",size:"small",plain:"",onClick:v=>X(o.row)},{default:l(()=>[k(" 编辑 ")]),_:2},1032,["onClick"]),t(s,{type:"danger",size:"small",plain:"",onClick:v=>Y(o.row)},{default:l(()=>[k(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[x,n.value.loading]]),t(le,{"current-page":f(c).page,total:f(c).total,"page-size":f(c).size,"page-sizes":f(c).sizes,layout:f(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:H,onCurrentChange:K},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[T,n.value.search.dictionaryId]]),I(p("div",Se,ze,512),[[T,!n.value.search.dictionaryId]])]),_:1}),i.value.dialog.visible?(m(),w(fe,{key:0,id:i.value.dialog.id,modelValue:i.value.dialog.visible,"onUpdate:modelValue":a[5]||(a[5]=o=>i.value.dialog.visible=o),row:i.value.row,"parent-id":i.value.dialog.parentId,tree:i.value.tree,onAddNode:y,onEditNode:y},null,8,["id","modelValue","row","parent-id","tree"])):M("",!0),n.value.dialog.visible?(m(),w(_e,{key:1,id:n.value.dialog.id,modelValue:n.value.dialog.visible,"onUpdate:modelValue":a[6]||(a[6]=o=>n.value.dialog.visible=o),"dictionary-id":n.value.search.dictionaryId,tree:i.value.tree,row:n.value.row,onSuccess:u},null,8,["id","modelValue","dictionary-id","tree","row"])):M("",!0)])])}}});typeof R=="function"&&R(P);const Re=me(P,[["__scopeId","data-v-60067d68"]]);export{Re as default};
