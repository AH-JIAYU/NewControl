
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{n as i,f as y,r as f,q as C,ao as E,h as d,ap as P,ai as S,k as t,o as _,c as V,a as o,w as r,b as v,a0 as D,a1 as G,i as M}from"./index-DEkb9qM_.js";import{a as N}from"./setting_role-BjzUHurx.js";import{u as O}from"./usePagination-BFgzm_nM.js";const b={list:l=>i.get("setting/user/list",{params:l,baseURL:"/mock/"}),detail:l=>i.get("setting/user/detail",{params:{id:l},baseURL:"/mock/"}),create:l=>i.post("setting/user/create",l,{baseURL:"/mock/"}),edit:l=>i.post("setting/user/edit",l,{baseURL:"/mock/"}),delete:l=>i.post("setting/user/delete",{id:l},{baseURL:"/mock/"}),passwordReset:l=>i.post("setting/user/password/reset",{id:l},{baseURL:"/mock/"}),changeStatus:l=>i.post("setting/user/change/status",l,{baseURL:"/mock/"}),check:l=>i.post("setting/user/check",l,{baseURL:"/mock/"})},z=y({__name:"index",props:{id:{default:""}},setup(l,{expose:R}){const U=l,{getParams:x}=O(),k=f([]),g=f(!1),c=f(),e=f({id:U.id,account:"",name:"",mobile:"",sex:"2",role_id:""}),L=f({account:[{required:!0,message:"请输入帐号",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:(n,a,m)=>{const u={key:"mobile",value:a};e.value.id!==""&&(u.id=e.value.id),b.check(u).then(p=>{p.data.exist?m(new Error("手机号已存在")):m()})},trigger:"blur"}]});C(()=>{const n={...x()};N.list(n).then(a=>{k.value=a.data.list}),e.value.id!==""&&h()});function h(){g.value=!0,b.detail(e.value.id).then(n=>{g.value=!1,e.value.account=n.data.account,e.value.name=n.data.name,e.value.mobile=n.data.mobile})}return R({submit(){return new Promise(n=>{e.value.id===""?c.value&&c.value.validate(a=>{a&&b.create(e.value).then(()=>{E.success({message:"模拟新增成功",center:!0}),n()})}):c.value&&c.value.validate(a=>{a&&b.edit(e.value).then(()=>{E.success({message:"模拟编辑成功",center:!0}),n()})})})}}),(n,a)=>{const m=d("ElInput"),u=d("ElFormItem"),p=d("ElRadioButton"),w=d("ElRadioGroup"),B=d("ElOption"),F=d("ElSelect"),I=d("ElForm"),q=P("loading");return S((_(),V("div",null,[o(I,{ref_key:"formRef",ref:c,model:t(e),rules:t(L),"label-width":"120px","label-suffix":"："},{default:r(()=>[o(u,{label:"帐号",prop:"account"},{default:r(()=>[o(m,{modelValue:t(e).account,"onUpdate:modelValue":a[0]||(a[0]=s=>t(e).account=s),placeholder:"请输入帐号"},null,8,["modelValue"])]),_:1}),o(u,{label:"姓名",prop:"name"},{default:r(()=>[o(m,{modelValue:t(e).name,"onUpdate:modelValue":a[1]||(a[1]=s=>t(e).name=s),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),o(u,{label:"手机号",prop:"mobile"},{default:r(()=>[o(m,{modelValue:t(e).mobile,"onUpdate:modelValue":a[2]||(a[2]=s=>t(e).mobile=s),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),o(u,{label:"性别",prop:"sex"},{default:r(()=>[o(w,{modelValue:t(e).sex,"onUpdate:modelValue":a[3]||(a[3]=s=>t(e).sex=s)},{default:r(()=>[o(p,{label:"2"},{default:r(()=>[v(" 保密 ")]),_:1}),o(p,{label:"1"},{default:r(()=>[v(" 男 ")]),_:1}),o(p,{label:"0"},{default:r(()=>[v(" 女 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(u,{label:"角色",prop:"role_id"},{default:r(()=>[o(F,{modelValue:t(e).role_id,"onUpdate:modelValue":a[4]||(a[4]=s=>t(e).role_id=s),placeholder:"请选择角色",clearable:""},{default:r(()=>[(_(!0),V(D,null,G(t(k),s=>(_(),M(B,{key:s.id,label:s.role,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])),[[q,t(g)]])}}});export{z as _,b as a};
