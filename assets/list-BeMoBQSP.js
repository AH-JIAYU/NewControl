
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as se}from"./index-CnSoASRf.js";import{f as re,r as k,y as de,X as $,h as d,aj as ce,o as m,c as ue,A as p,a,w as l,b as E,ak as I,i as D,B as w,au as S,c9 as T,k as f,l as M,cm as N,ai as z,H as pe,bG as ve,bE as ge,_ as me,d as R}from"./index-qQLkOm5f.js";import fe from"./index-CCbxPdw9.js";import _e from"./index-Ds6wWh1o.js";import{a as _}from"./setting_basisDictionary-2IobHlju.js";import{u as he}from"./usePagination-ByyK1qde.js";const ye=h=>(ve("data-v-aeff9bfc"),h=h(),ge(),h),be={class:"absolute-container"},Ce={class:"page-main"},ke={class:"custom-tree-node"},Ee=["title"],Ie={class:"code"},De={class:"actions"},we={class:"dictionary-container"},Se={class:"dictionary-container"},Ne=ye(()=>p("div",{class:"empty"}," 请在左侧新增或选择一个字典 ",-1)),ze=[Ne],U=re({name:"SettingBasisDictionaryList",__name:"list",setup(h){const V=k(),i=k({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),{pagination:c,onSizeChange:A,onCurrentChange:G,onSortChange:P}=he();c.value.size=20,c.value.sizes=[20,50,100];const J=k(),n=k({loading:!1,search:{dictionaryId:"",title:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:""}});function y(){i.value.loading=!0,n.value.search.dictionaryId="",_.list().then(e=>{i.value.tree=e.data,i.value.loading=!1})}de(()=>{y()}),$(()=>i.value.search,e=>{V.value.filter(e)});function O(e,t){return e?t.label.includes(e):!0}function L(e){i.value.currentData=e,i.value.dialog.parentId=(e==null?void 0:e.id)??"",i.value.dialog.id="",i.value.dialog.visible=!0}function j(e,t){i.value.currentNode=e,i.value.currentData=t,i.value.row=JSON.stringify(t),i.value.dialog.parentId=e.parent.data.id??"",i.value.dialog.id=t.id,i.value.dialog.visible=!0}function F(e,t){N.confirm(`确认删除「${t.chineseName}」吗？`,"确认信息").then(()=>{_.delete(t.id).then(()=>{z.success({message:"删除成功",center:!0});const s=e.parent,r=s.data.children||s.data,b=r.findIndex(C=>C.id===t.id);r.splice(b,1),i.value.tree=[...i.value.tree]})})}function H(e){c.value.page=1,n.value.search.dictionaryId=e.id}$(()=>n.value.search.dictionaryId,()=>{u()});function u(){n.value.loading=!0,_.itemList({page:1,limit:10,id:n.value.search.dictionaryId}).then(e=>{n.value.loading=!1,n.value.dataList=e.data.records,n.value.dataList.forEach(t=>{t.enableLoading=!1}),c.value.total=Number.parseInt(e.data.total)})}function X(e){A(e).then(()=>u())}function q(e=1){G(e).then(()=>u())}function K({prop:e,order:t}){P(e,t).then(()=>u())}function Q(){n.value.dialog.id="",n.value.dialog.visible=!0}function W(e){n.value.row=JSON.stringify(e),n.value.dialog.id=e.id,n.value.dialog.visible=!0}function Y(e){N.confirm(`确认删除「${e.chineseName}」吗？`,"确认信息").then(()=>{_.itemDelete(e.id).then(()=>{u(),z.success({message:"删除成功",center:!0})})}).catch(()=>{})}function Z(e){N.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{_.itemDelete(e.map(t=>t.id)).then(()=>{u(),z.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(e,t)=>{const s=d("ElButton"),r=pe,b=d("ElButtonGroup"),C=d("ElInput"),ee=d("ElTree"),ae=d("ElScrollbar"),te=d("ElSpace"),g=d("ElTableColumn"),ie=d("ElTag"),ne=d("ElTable"),le=d("ElPagination"),oe=se,x=ce("loading");return m(),ue("div",be,[p("div",Ce,[a(oe,{"hide-left-side-toggle":""},{leftSide:l(()=>[a(b,{class:"btns"},{default:l(()=>[a(s,{type:"primary",class:"add",onClick:t[0]||(t[0]=o=>L())},{default:l(()=>[E(" 新增字典 ")]),_:1}),a(s,{onClick:y},{icon:l(()=>[a(r,{name:"i-ep:refresh"})]),_:1})]),_:1}),a(C,{modelValue:i.value.search,"onUpdate:modelValue":t[1]||(t[1]=o=>i.value.search=o),placeholder:"请输入关键词筛选字典",clearable:"",class:"search"},null,8,["modelValue"]),a(ae,{class:"tree"},{default:l(()=>[I((m(),D(ee,{ref_key:"dictionaryRef",ref:V,data:i.value.tree,"filter-node-method":O,"default-expand-all":"",onNodeClick:H},{default:l(({node:o,data:v})=>[p("div",ke,[p("div",{class:"label",title:o.label},w(v.chineseName),9,Ee),p("div",Ie,w(v.englishName),1),p("div",De,[a(b,null,{default:l(()=>[a(s,{type:"primary",plain:"",size:"default",onClick:S(B=>L(v),["stop"])},{icon:l(()=>[a(r,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),a(s,{type:"info",plain:"",size:"default",onClick:S(B=>j(o,v),["stop"])},{icon:l(()=>[a(r,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),a(s,{type:"danger",plain:"",size:"default",onClick:S(B=>F(o,v),["stop"])},{icon:l(()=>[a(r,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[x,i.value.loading]])]),_:1})]),default:l(()=>[I(p("div",we,[a(te,{wrap:""},{default:l(()=>[a(s,{type:"primary",onClick:Q},{icon:l(()=>[a(r,{name:"i-ep:plus"})]),_:1}),a(s,{type:"danger",disabled:!n.value.selectionDataList.length,onClick:t[2]||(t[2]=o=>Z(n.value.selectionDataList))},{icon:l(()=>[a(r,{name:"i-ep:delete"})]),_:1},8,["disabled"]),a(C,{modelValue:n.value.search.title,"onUpdate:modelValue":t[3]||(t[3]=o=>n.value.search.title=o),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),a(s,{onClick:u},{icon:l(()=>[a(r,{name:"i-ep:search"})]),_:1})]),_:1}),I((m(),D(ne,{ref_key:"dictionaryItemRef",ref:J,data:n.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:K,onSelectionChange:t[4]||(t[4]=o=>n.value.selectionDataList=o)},{default:l(()=>[a(g,{type:"selection",align:"center",fixed:""}),a(g,{prop:"chineseName",label:"中文名称"}),a(g,{prop:"englishName",label:"英文名称"}),a(g,{label:"键值",align:"center",width:"150"},{default:l(o=>[a(ie,{type:"info"},{default:l(()=>[E(w(o.row.code),1)]),_:2},1024)]),_:1}),a(g,{label:"操作",width:"200",align:"center"},{default:l(o=>[a(s,{type:"primary",size:"small",plain:"",onClick:v=>W(o.row)},{default:l(()=>[E(" 编辑 ")]),_:2},1032,["onClick"]),a(s,{type:"danger",size:"small",plain:"",onClick:v=>Y(o.row)},{default:l(()=>[E(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[x,n.value.loading]]),a(le,{"current-page":f(c).page,total:f(c).total,"page-size":f(c).size,"page-sizes":f(c).sizes,layout:f(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:X,onCurrentChange:q},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[T,n.value.search.dictionaryId]]),I(p("div",Se,ze,512),[[T,!n.value.search.dictionaryId]])]),_:1}),i.value.dialog.visible?(m(),D(fe,{key:0,id:i.value.dialog.id,modelValue:i.value.dialog.visible,"onUpdate:modelValue":t[5]||(t[5]=o=>i.value.dialog.visible=o),row:i.value.row,"parent-id":i.value.dialog.parentId,tree:i.value.tree,onAddNode:y,onEditNode:y},null,8,["id","modelValue","row","parent-id","tree"])):M("",!0),n.value.dialog.visible?(m(),D(_e,{key:1,id:n.value.dialog.id,modelValue:n.value.dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=o=>n.value.dialog.visible=o),"dictionary-id":n.value.search.dictionaryId,tree:i.value.tree,row:n.value.row,onSuccess:u},null,8,["id","modelValue","dictionary-id","tree","row"])):M("",!0)])])}}});typeof R=="function"&&R(U);const Me=me(U,[["__scopeId","data-v-aeff9bfc"]]);export{Me as default};
